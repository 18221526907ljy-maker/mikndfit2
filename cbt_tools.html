<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CBTè‡ªåŠ©å·¥å…· - MindFit</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" />
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: "#4A6157",
            secondary: "#F7F6F2",
            accent: "#2E2E2E",
            mint: "#8FD9A8"
          }
        }
      }
    };
  </script>

  <style>
    .tool-card {
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .tool-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
    }

    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: rgba(0, 0, 0, 0.85);
      color: white;
      padding: 12px 24px;
      border-radius: 25px;
      z-index: 1000;
      opacity: 0;
      transition: all 0.4s ease;
    }
    
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .record-item {
      transition: all 0.2s ease;
      cursor: pointer;
    }

    .record-item:hover {
      background: #f9fafb;
    }

    .badge-high { background: rgba(239, 68, 68, 0.1); color: #dc2626; }
    .badge-medium { background: rgba(249, 115, 22, 0.1); color: #ea580c; }
    .badge-low { background: rgba(34, 197, 94, 0.1); color: #16a34a; }
  </style>
</head>

<body class="bg-secondary font-sans min-h-screen">
  
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <nav class="bg-white border-b border-gray-200 sticky top-0 z-50 backdrop-blur-md bg-white/90">
    <div class="max-w-6xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <a href="index.html" class="flex items-center text-primary hover:text-mint transition-all duration-300 group">
            <span class="mr-2 transition-transform group-hover:-translate-x-1">â†</span>
            <span class="font-medium">è¿”å›é¦–é¡µ</span>
          </a>
        </div>
        <div class="flex items-center space-x-2">
          <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center">
            <i class="fa fa-brain text-white text-sm"></i>
          </div>
          <span class="text-lg font-bold text-primary">CBTå·¥å…·ç®±</span>
        </div>
      </div>
    </div>
  </nav>

  <!-- Toast æç¤º -->
  <div id="toast" class="toast">
    <div class="flex items-center">
      <span class="mr-2">âœ“</span>
      <span id="toastMessage"></span>
    </div>
  </div>

  <main class="max-w-6xl mx-auto px-4 py-8">
    <div class="page-content">
      
      <!-- é¡µé¢æ ‡é¢˜ -->
      <div class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-bold text-primary mb-2">CBT è‡ªåŠ©å·¥å…·ç®±</h1>
        <p class="text-gray-600 text-lg">è®¤çŸ¥è¡Œä¸ºç–—æ³•å·¥å…·ï¼Œå¸®åŠ©ä½ è¯†åˆ«å’Œæ”¹å˜è´Ÿé¢æ€ç»´æ¨¡å¼</p>
      </div>

      <!-- ä»‹ç»å¡ç‰‡ -->
      <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-2xl p-6 mb-8 border border-blue-100">
        <div class="flex items-start space-x-4">
          <div class="w-12 h-12 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
            <i class="fa fa-lightbulb-o text-white text-xl"></i>
          </div>
          <div>
            <h3 class="font-semibold text-primary mb-2">ä»€ä¹ˆæ˜¯CBTï¼Ÿ</h3>
            <p class="text-sm text-gray-700 leading-relaxed">
              è®¤çŸ¥è¡Œä¸ºç–—æ³•ï¼ˆCBTï¼‰æ˜¯ä¸€ç§ç§‘å­¦æœ‰æ•ˆçš„å¿ƒç†æ²»ç–—æ–¹æ³•ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬è¯†åˆ«å¹¶æ”¹å˜ä¸åˆç†çš„æ€ç»´æ¨¡å¼ï¼Œ
              ä»è€Œæ”¹å–„æƒ…ç»ªå’Œè¡Œä¸ºã€‚é€šè¿‡è®°å½•å’Œåˆ†æè‡ªå·±çš„æƒ³æ³•ï¼Œä½ å¯ä»¥å­¦ä¼šç”¨æ›´ç†æ€§ã€å¹³è¡¡çš„æ–¹å¼çœ‹å¾…é—®é¢˜ã€‚
            </p>
          </div>
        </div>
      </div>

      <!-- å·¥å…·åˆ†ç±»æ ‡ç­¾ -->
      <div class="flex items-center justify-center gap-4 mb-8">
        <button class="tool-filter-btn px-6 py-2 rounded-full bg-primary text-white font-medium" data-category="all">
          å…¨éƒ¨å·¥å…·
        </button>
        <button class="tool-filter-btn px-6 py-2 rounded-full bg-gray-200 text-gray-600 font-medium" data-category="general">
          é€šç”¨CBT
        </button>
        <button class="tool-filter-btn px-6 py-2 rounded-full bg-gray-200 text-gray-600 font-medium" data-category="body-neutral">
          ğŸŒ¿ èº«ä½“ä¸­ç«‹
        </button>
      </div>

      <!-- å·¥å…·å¡ç‰‡ -->
      <div class="grid md:grid-cols-3 gap-6 mb-12">
        
        <!-- é€šç”¨CBTå·¥å…· -->
        
        <!-- æ€ç»´è®°å½• -->
        <div class="tool-card bg-white rounded-2xl p-6 shadow-sm" data-category="general" onclick="window.location.href='thought_record.html'">
          <div class="w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mb-4">
            <i class="fa fa-pencil text-blue-600 text-2xl"></i>
          </div>
          <h3 class="text-xl font-bold text-primary mb-2">æ€ç»´è®°å½•</h3>
          <p class="text-sm text-gray-600 mb-4">
            è®°å½•è´Ÿé¢æƒ³æ³•ï¼Œè¯†åˆ«è®¤çŸ¥æ‰­æ›²ï¼Œç”¨ç†æ€§æ€ç»´æ›¿ä»£
          </p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-500" id="thoughtCount">0 æ¡è®°å½•</span>
            <button class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-mint transition-colors">
              å¼€å§‹è®°å½• â†’
            </button>
          </div>
        </div>

        <!-- æƒ…ç»ªæ—¥è®° -->
        <div class="tool-card bg-white rounded-2xl p-6 shadow-sm" data-category="general" onclick="window.location.href='emotion_diary.html'">
          <div class="w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mb-4">
            <i class="fa fa-heart text-purple-600 text-2xl"></i>
          </div>
          <h3 class="text-xl font-bold text-primary mb-2">æƒ…ç»ªæ—¥è®°</h3>
          <p class="text-sm text-gray-600 mb-4">
            è¿½è¸ªæ¯æ—¥æƒ…ç»ªå˜åŒ–ï¼Œè¯†åˆ«æƒ…ç»ªè§¦å‘ç‚¹å’Œæ¨¡å¼
          </p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-500" id="emotionCount">0 æ¡è®°å½•</span>
            <button class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-mint transition-colors">
              è®°å½•æƒ…ç»ª â†’
            </button>
          </div>
        </div>

        <!-- èº«ä½“ä¸­ç«‹ä¸“å±å·¥å…· -->
        
        <!-- èº«ä½“æ„è±¡è®¤çŸ¥é‡æ„ -->
        <div class="tool-card bg-white rounded-2xl p-6 shadow-sm" data-category="body-neutral" onclick="window.location.href='body-image-reframe.html'">
          <div class="w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mb-4">
            <i class="fa fa-user-circle text-green-600 text-2xl"></i>
          </div>
          <div class="flex items-center mb-2">
            <h3 class="text-xl font-bold text-primary">èº«ä½“æ„è±¡é‡æ„</h3>
            <span class="ml-2 text-xs bg-green-100 text-green-700 px-2 py-1 rounded">ğŸ†•</span>
          </div>
          <p class="text-sm text-gray-600 mb-4">
            ç³»ç»Ÿæ€§è¯†åˆ«å’Œæ”¹å˜å¯¹èº«ä½“çš„è´Ÿé¢æ€ç»´æ¨¡å¼
          </p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-500" id="bodyImageCount">0 æ¡è®°å½•</span>
            <button class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-mint transition-colors">
              å¼€å§‹é‡æ„ â†’
            </button>
          </div>
        </div>

        <!-- ç¤¾äº¤åª’ä½“å½±å“è¿½è¸ªå™¨ -->
        <div class="tool-card bg-white rounded-2xl p-6 shadow-sm" data-category="body-neutral" onclick="window.location.href='social-media-tracker.html'">
          <div class="w-16 h-16 bg-cyan-100 rounded-2xl flex items-center justify-center mb-4">
            <i class="fa fa-mobile text-cyan-600 text-2xl"></i>
          </div>
          <div class="flex items-center mb-2">
            <h3 class="text-xl font-bold text-primary">ç¤¾äº¤åª’ä½“è¿½è¸ª</h3>
            <span class="ml-2 text-xs bg-cyan-100 text-cyan-700 px-2 py-1 rounded">ğŸ†•</span>
          </div>
          <p class="text-sm text-gray-600 mb-4">
            è®°å½•ç¤¾äº¤åª’ä½“å¦‚ä½•å½±å“ä½ çš„èº«æç„¦è™‘
          </p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-500" id="socialMediaCount">0 æ¡è®°å½•</span>
            <button class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-mint transition-colors">
              å¼€å§‹è¿½è¸ª â†’
            </button>
          </div>
        </div>

        <!-- é¥®é£Ÿä¸æƒ…ç»ªæ—¥å¿— -->
        <div class="tool-card bg-white rounded-2xl p-6 shadow-sm" data-category="body-neutral" onclick="window.location.href='eating-emotion-log.html'">
          <div class="w-16 h-16 bg-orange-100 rounded-2xl flex items-center justify-center mb-4">
            <i class="fa fa-cutlery text-orange-600 text-2xl"></i>
          </div>
          <div class="flex items-center mb-2">
            <h3 class="text-xl font-bold text-primary">é¥®é£Ÿæƒ…ç»ªæ—¥å¿—</h3>
            <span class="ml-2 text-xs bg-orange-100 text-orange-700 px-2 py-1 rounded">ğŸ†•</span>
          </div>
          <p class="text-sm text-gray-600 mb-4">
            è¯†åˆ«æƒ…ç»ªåŒ–è¿›é£Ÿæ¨¡å¼ï¼Œå»ºç«‹å¥åº·é¥®é£Ÿå…³ç³»
          </p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-500" id="eatingEmotionCount">0 æ¡è®°å½•</span>
            <button class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-mint transition-colors">
              å¼€å§‹è®°å½• â†’
            </button>
          </div>
        </div>

        <!-- è¡Œä¸ºå®éªŒ - å³å°†æ¨å‡º -->
        <div class="tool-card bg-white rounded-2xl p-6 shadow-sm opacity-60" data-category="general">
          <div class="w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mb-4">
            <i class="fa fa-flask text-gray-400 text-2xl"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-400 mb-2">è¡Œä¸ºå®éªŒ</h3>
          <p class="text-sm text-gray-400 mb-4">
            æµ‹è¯•è´Ÿé¢é¢„æœŸï¼Œç”¨å®é™…ç»éªŒæŒ‘æˆ˜ç„¦è™‘æƒ³æ³•
          </p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-400">å³å°†æ¨å‡º</span>
            <button class="bg-gray-200 text-gray-400 px-4 py-2 rounded-lg text-sm font-medium cursor-not-allowed">
              æ•¬è¯·æœŸå¾…
            </button>
          </div>
        </div>

      </div>

      <!-- æœ€è¿‘çš„è®°å½• -->
      <div class="bg-white rounded-2xl p-6 shadow-sm mb-8">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-semibold text-primary">æœ€è¿‘çš„è®°å½•</h2>
          <button onclick="refreshRecords()" class="text-primary hover:text-mint transition-colors">
            <i class="fa fa-refresh"></i> åˆ·æ–°
          </button>
        </div>

        <div id="recentRecords">
          <!-- åŠ¨æ€åŠ è½½ -->
        </div>

        <!-- ç©ºçŠ¶æ€ -->
        <div id="emptyState" class="text-center py-12 hidden">
          <div class="text-6xl mb-4">ğŸ“</div>
          <h3 class="text-lg font-semibold text-gray-700 mb-2">è¿˜æ²¡æœ‰è®°å½•</h3>
          <p class="text-gray-500 mb-6">å¼€å§‹ä½ çš„ç¬¬ä¸€æ¬¡è®°å½•ï¼Œå»ºç«‹æ›´å¥åº·çš„æ€ç»´æ¨¡å¼</p>
          <button onclick="window.location.href='thought_record.html'" class="bg-primary text-white px-6 py-3 rounded-lg font-medium hover:bg-mint transition-colors">
            å¼€å§‹è®°å½•
          </button>
        </div>
      </div>

      <!-- é…å¥—ç»ƒä¹ æ¨è -->
      <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6 border-2 border-purple-200">
        <h3 class="text-xl font-bold text-purple-900 mb-4">
          <i class="fa fa-lightbulb-o mr-2"></i>
          ğŸ’¡ é…å¥—è½»é‡ç»ƒä¹ æ¨è
        </h3>
        <p class="text-sm text-purple-800 mb-4">
          ä½¿ç”¨æ·±åº¦å·¥å…·å‰ï¼Œå…ˆåšä¸€æ¬¡è½»é‡ç»ƒä¹ å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°å‡†å¤‡å¿ƒæ€
        </p>
        <div class="grid md:grid-cols-3 gap-4">
          <div class="bg-white rounded-lg p-4 border border-purple-200">
            <div class="font-medium text-gray-800 mb-2">ğŸª é•œå­å‹å–„ç»ƒä¹ </div>
            <p class="text-xs text-gray-600 mb-3">é…å¥—:èº«ä½“æ„è±¡é‡æ„å·¥å…·</p>
            <button onclick="window.location.href='mirror-kindness.html'" class="w-full bg-purple-100 hover:bg-purple-200 text-purple-700 py-2 rounded text-sm transition-colors">
              å»ç»ƒä¹ 
            </button>
          </div>
          
          <div class="bg-white rounded-lg p-4 border border-purple-200">
            <div class="font-medium text-gray-800 mb-2">ğŸ“± ç¤¾äº¤åª’ä½“æ¸…é†’</div>
            <p class="text-xs text-gray-600 mb-3">é…å¥—:ç¤¾äº¤åª’ä½“è¿½è¸ªå™¨</p>
            <button onclick="window.location.href='social-media-detox.html'" class="w-full bg-purple-100 hover:bg-purple-200 text-purple-700 py-2 rounded text-sm transition-colors">
              å»ç»ƒä¹ 
            </button>
          </div>
          
          <div class="bg-white rounded-lg p-4 border border-purple-200">
            <div class="font-medium text-gray-800 mb-2">ğŸ½ï¸ æ— ç½ªæ„Ÿé¥®é£Ÿ</div>
            <p class="text-xs text-gray-600 mb-3">é…å¥—:é¥®é£Ÿæƒ…ç»ªæ—¥å¿—</p>
            <button onclick="window.location.href='mindful-eating-light.html'" class="w-full bg-purple-100 hover:bg-purple-200 text-purple-700 py-2 rounded text-sm transition-colors">
              å»ç»ƒä¹ 
            </button>
          </div>
        </div>
      </div>

      <!-- ä½¿ç”¨æŠ€å·§ -->
      <div class="mt-8 bg-white rounded-2xl p-6 shadow-sm">
        <h3 class="font-semibold text-primary mb-4">ğŸ’¡ ä½¿ç”¨æŠ€å·§</h3>
        <div class="space-y-3 text-sm text-gray-600">
          <div class="flex items-start">
            <span class="text-mint mr-2">âœ“</span>
            <span>æ¯å¤©èŠ±5-10åˆ†é’Ÿè®°å½•ï¼Œæ•ˆæœæœ€ä½³</span>
          </div>
          <div class="flex items-start">
            <span class="text-mint mr-2">âœ“</span>
            <span>åœ¨æƒ…ç»ªå¼ºçƒˆæ—¶è®°å½•ï¼Œæ›´å®¹æ˜“è¯†åˆ«è´Ÿé¢æƒ³æ³•</span>
          </div>
          <div class="flex items-start">
            <span class="text-mint mr-2">âœ“</span>
            <span>å®šæœŸå›é¡¾è®°å½•ï¼Œè§‚å¯Ÿè‡ªå·±çš„è¿›æ­¥</span>
          </div>
          <div class="flex items-start">
            <span class="text-mint mr-2">âœ“</span>
            <span>ä¸è¦å¼ºæ±‚å®Œç¾ï¼Œè®°å½•æœ¬èº«å°±æ˜¯ç»ƒä¹ </span>
          </div>
          <div class="flex items-start">
            <span class="text-mint mr-2">âœ“</span>
            <span>é…åˆè½»é‡ç»ƒä¹ ä½¿ç”¨ï¼Œæ•ˆæœæ›´ä½³</span>
          </div>
        </div>
      </div>

    </div>
  </main>

  <script>
    // ============================================
    // Toast æç¤º
    // ============================================
    
    function showToast(message) {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      toastMessage.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // ============================================
    // åˆ†ç±»è¿‡æ»¤
    // ============================================
    
    function initToolFilter() {
      const filterBtns = document.querySelectorAll('.tool-filter-btn');
      const toolCards = document.querySelectorAll('.tool-card');
      
      filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const category = btn.dataset.category;
          
          // æ›´æ–°æŒ‰é’®çŠ¶æ€
          filterBtns.forEach(b => {
            b.classList.remove('bg-primary', 'text-white');
            b.classList.add('bg-gray-200', 'text-gray-600');
          });
          btn.classList.remove('bg-gray-200', 'text-gray-600');
          btn.classList.add('bg-primary', 'text-white');
          
          // è¿‡æ»¤å¡ç‰‡
          toolCards.forEach(card => {
            if (category === 'all' || card.dataset.category === category) {
              card.style.display = 'block';
            } else {
              card.style.display = 'none';
            }
          });
        });
      });
    }

    // ============================================
    // åŠ è½½ç»Ÿè®¡
    // ============================================
    
    function loadStats() {
      try {
        const thoughtRecords = JSON.parse(localStorage.getItem('thoughtRecords') || '[]');
        const emotionDiary = JSON.parse(localStorage.getItem('emotionDiary') || '[]');
        const bodyImageRecords = JSON.parse(localStorage.getItem('bodyImageRecords') || '[]');
        const socialMediaRecords = JSON.parse(localStorage.getItem('socialMediaRecords') || '[]');
        const eatingEmotionRecords = JSON.parse(localStorage.getItem('eatingEmotionRecords') || '[]');
        
        document.getElementById('thoughtCount').textContent = `${thoughtRecords.length} æ¡è®°å½•`;
        document.getElementById('emotionCount').textContent = `${emotionDiary.length} æ¡è®°å½•`;
        document.getElementById('bodyImageCount').textContent = `${bodyImageRecords.length} æ¡è®°å½•`;
        document.getElementById('socialMediaCount').textContent = `${socialMediaRecords.length} æ¡è®°å½•`;
        document.getElementById('eatingEmotionCount').textContent = `${eatingEmotionRecords.length} æ¡è®°å½•`;
        
        loadRecentRecords(thoughtRecords, emotionDiary, bodyImageRecords, socialMediaRecords, eatingEmotionRecords);
      } catch (error) {
        console.error('åŠ è½½ç»Ÿè®¡å¤±è´¥:', error);
      }
    }

    // ============================================
    // åŠ è½½æœ€è¿‘çš„è®°å½•
    // ============================================
    
    function loadRecentRecords(thoughtRecords, emotionDiary, bodyImageRecords, socialMediaRecords, eatingEmotionRecords) {
      const container = document.getElementById('recentRecords');
      const emptyState = document.getElementById('emptyState');
      
      // åˆå¹¶æ‰€æœ‰è®°å½•å¹¶æ’åº
      const allRecords = [
        ...thoughtRecords.map(r => ({ ...r, type: 'thought' })),
        ...emotionDiary.map(r => ({ ...r, type: 'emotion' })),
        ...bodyImageRecords.map(r => ({ ...r, type: 'body-image' })),
        ...socialMediaRecords.map(r => ({ ...r, type: 'social-media' })),
        ...eatingEmotionRecords.map(r => ({ ...r, type: 'eating-emotion' }))
      ].sort((a, b) => b.id - a.id).slice(0, 8);
      
      if (allRecords.length === 0) {
        container.classList.add('hidden');
        emptyState.classList.remove('hidden');
        return;
      }
      
      container.classList.remove('hidden');
      emptyState.classList.add('hidden');
      
      container.innerHTML = allRecords.map(record => {
        switch(record.type) {
          case 'thought': return renderThoughtRecord(record);
          case 'emotion': return renderEmotionRecord(record);
          case 'body-image': return renderBodyImageRecord(record);
          case 'social-media': return renderSocialMediaRecord(record);
          case 'eating-emotion': return renderEatingEmotionRecord(record);
          default: return '';
        }
      }).join('');
    }

    // æ¸²æŸ“æ€ç»´è®°å½•
    function renderThoughtRecord(record) {
      const date = new Date(record.id);
      const dateStr = date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' });
      const timeStr = date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
      
      const intensityBadge = record.emotionIntensity >= 7 ? 'badge-high' : 
                             record.emotionIntensity >= 4 ? 'badge-medium' : 'badge-low';
      
      return `
        <div class="record-item p-4 border-b border-gray-100 last:border-0" onclick="window.location.href='thought_record.html?view=${record.id}'">
          <div class="flex items-start justify-between mb-2">
            <div class="flex items-center space-x-2">
              <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                <i class="fa fa-pencil text-blue-600 text-sm"></i>
              </div>
              <div>
                <div class="font-medium text-gray-800">æ€ç»´è®°å½•</div>
                <div class="text-xs text-gray-500">${dateStr} ${timeStr}</div>
              </div>
            </div>
            <span class="badge ${intensityBadge}">
              å¼ºåº¦ ${record.emotionIntensity}/10
            </span>
          </div>
          <p class="text-sm text-gray-600 line-clamp-2 ml-10">
            ${record.negativeThought}
          </p>
        </div>
      `;
    }

    // æ¸²æŸ“æƒ…ç»ªè®°å½•
    function renderEmotionRecord(record) {
      const date = new Date(record.id);
      const dateStr = date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' });
      const timeStr = date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
      
      const intensityBadge = record.intensity >= 7 ? 'badge-high' : 
                             record.intensity >= 4 ? 'badge-medium' : 'badge-low';
      
      return `
        <div class="record-item p-4 border-b border-gray-100 last:border-0" onclick="window.location.href='emotion_diary.html?view=${record.id}'">
          <div class="flex items-start justify-between mb-2">
            <div class="flex items-center space-x-2">
              <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                <span class="text-lg">${record.emoji || 'ğŸ’­'}</span>
              </div>
              <div>
                <div class="font-medium text-gray-800">æƒ…ç»ªæ—¥è®°</div>
                <div class="text-xs text-gray-500">${dateStr} ${timeStr}</div>
              </div>
            </div>
            <span class="badge ${intensityBadge}">
              å¼ºåº¦ ${record.intensity}/10
            </span>
          </div>
          <p class="text-sm text-gray-600 line-clamp-2 ml-10">
            ${record.emotionLabel}: ${record.trigger || 'æ— è§¦å‘äº‹ä»¶'}
          </p>
        </div>
      `;
    }

    // æ¸²æŸ“èº«ä½“æ„è±¡è®°å½•
    function renderBodyImageRecord(record) {
      const date = new Date(record.id);
      const dateStr = date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' });
      const timeStr = date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
      
      const beliefChange = record.beliefBefore - record.beliefAfter;
      const changeBadge = beliefChange > 2 ? 'badge-low' : beliefChange > 0 ? 'badge-medium' : 'badge-high';
      
      return `
        <div class="record-item p-4 border-b border-gray-100 last:border-0">
          <div class="flex items-start justify-between mb-2">
            <div class="flex items-center space-x-2">
              <div class="w-8 h-8 bg-cyan-100 rounded-lg flex items-center justify-center">
                <i class="fa fa-mobile text-cyan-600 text-sm"></i>
              </div>
              <div>
                <div class="font-medium text-gray-800">ç¤¾äº¤åª’ä½“è¿½è¸ª</div>
                <div class="text-xs text-gray-500">${dateStr} ${timeStr} Â· ${platformNames[record.platform] || record.platform}</div>
              </div>
            </div>
            <span class="badge badge-${parseFloat(record.avgEmotion) >= 7 ? 'high' : parseFloat(record.avgEmotion) >= 4 ? 'medium' : 'low'}">
              å¼ºåº¦ ${record.avgEmotion}/10
            </span>
          </div>
          <p class="text-sm text-gray-600 line-clamp-2 ml-10">
            ${record.automaticThought}
          </p>
        </div>
      `;
    }

    // æ¸²æŸ“é¥®é£Ÿæƒ…ç»ªè®°å½•
    function renderEatingEmotionRecord(record) {
      const date = new Date(record.id);
      const dateStr = date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' });
      const timeStr = date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
      
      const mealTypeNames = {
        'breakfast': 'æ—©é¤',
        'lunch': 'åˆé¤',
        'dinner': 'æ™šé¤',
        'snack': 'é›¶é£Ÿ'
      };
      
      return `
        <div class="record-item p-4 border-b border-gray-100 last:border-0">
          <div class="flex items-start justify-between mb-2">
            <div class="flex items-center space-x-2">
              <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center">
                <i class="fa fa-cutlery text-orange-600 text-sm"></i>
              </div>
              <div>
                <div class="font-medium text-gray-800">é¥®é£Ÿæƒ…ç»ªæ—¥å¿—</div>
                <div class="text-xs text-gray-500">${dateStr} ${timeStr} Â· ${mealTypeNames[record.mealType] || record.mealType}</div>
              </div>
            </div>
            <span class="badge badge-${record.guiltLevel >= 7 ? 'high' : record.guiltLevel >= 4 ? 'medium' : 'low'}">
              ${record.isEmotionalEating ? 'ğŸ’­ æƒ…ç»ªåŒ–' : 'âœ… ç”Ÿç†æ€§'}
            </span>
          </div>
          <p class="text-sm text-gray-600 line-clamp-2 ml-10">
            ${record.foodDescription}
          </p>
        </div>
      `;
    }

    // åˆ·æ–°è®°å½•
    function refreshRecords() {
      loadStats();
      showToast('å·²åˆ·æ–°è®°å½•åˆ—è¡¨');
    }

    // ============================================
    // é¡µé¢åŠ è½½
    // ============================================
    
    document.addEventListener('DOMContentLoaded', () => {
      initToolFilter();
      loadStats();
      
      setTimeout(() => {
        showToast('æ¬¢è¿ä½¿ç”¨CBTè‡ªåŠ©å·¥å…·ç®±ï¼');
      }, 1000);
    });
  </script>

</body>
</html><div class="flex items-start justify-between mb-2">
            <div class="flex items-center space-x-2">
              <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                <i class="fa fa-user-circle text-green-600 text-sm"></i>
              </div>
              <div>
                <div class="font-medium text-gray-800">èº«ä½“æ„è±¡é‡æ„</div>
                <div class="text-xs text-gray-500">${dateStr} ${timeStr}</div>
              </div>
            </div>
            <span class="badge ${changeBadge}">
              ${beliefChange > 0 ? 'â†“' : 'â†‘'} ${Math.abs(beliefChange)} åˆ†
            </span>
          </div>
          <p class="text-sm text-gray-600 line-clamp-2 ml-10">
            ${record.negativeThought}
          </p>
        </div>
      `;
    }

    // æ¸²æŸ“ç¤¾äº¤åª’ä½“è®°å½•
    function renderSocialMediaRecord(record) {
      const date = new Date(record.id);
      const dateStr = date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' });
      const timeStr = date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
      
      const platformNames = {
        'instagram': 'Instagram',
        'xiaohongshu': 'å°çº¢ä¹¦',
        'douyin': 'æŠ–éŸ³',
        'weibo': 'å¾®åš'
      };
      
      return `
        <div class="record-item p-4 border-b border-gray-100 last:border-0">
