<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>了解自己 - MindFit</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: "#4A6157",
            secondary: "#F7F6F2", 
            accent: "#2E2E2E",
            mint: "#8FD9A8",
            light: "#FAFAFA",
            white: "#FFFFFF",
            content: "#444444",
            gray: "#666666",
            lightGray: "#777777",
          },
        },
      },
    };
  </script>
  
  <style>
    .assessment-card {
      background: #FFFFFF;
      border: 1px solid rgba(74, 97, 87, 0.1);
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow: 0 8px 32px rgba(74, 97, 87, 0.08);
      cursor: pointer;
    }
    
    .assessment-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 40px rgba(74, 97, 87, 0.15);
      border-color: rgba(143, 217, 168, 0.3);
    }

    .icon-container {
      transition: all 0.3s ease;
    }

    .icon-container:hover {
      transform: scale(1.1) rotate(5deg);
    }

    .history-item {
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .history-item:hover {
      border-left-color: #8FD9A8;
      background: rgba(143, 217, 168, 0.05);
      transform: translateX(4px);
    }
  </style>
</head>

<body class="bg-secondary font-sans min-h-screen">
  <!-- 顶部导航 -->
  <nav class="bg-white border-b border-gray-200 sticky top-0 z-50 backdrop-blur-md bg-white/90">
    <div class="max-w-4xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <a href="index.html" class="flex items-center text-primary hover:text-mint transition-all duration-300 group">
            <span class="mr-2 transition-transform group-hover:-translate-x-1">←</span>
            <span class="font-medium">返回首页</span>
          </a>
        </div>
        <div class="flex items-center space-x-2">
          <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center">
            <span class="text-white text-sm">💗</span>
          </div>
          <span class="text-lg font-bold text-primary">MindFit</span>
        </div>
      </div>
    </div>
  </nav>

  <main class="max-w-4xl mx-auto px-4 py-8">
    
    <div class="text-center mb-8">
      <h1 class="text-3xl md:text-4xl font-bold text-primary mb-4">了解自己</h1>
      <p class="text-content text-lg">通过科学测评，更好地认知当下的自己</p>
    </div>

    <div class="grid md:grid-cols-2 gap-8 mb-8">
      <!-- BMI测评卡片 -->
      <div class="assessment-card rounded-2xl p-8" onclick="window.location.href='assessment-test.html?type=bmi'">
        <div class="text-center">
          <div class="icon-container w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center">
            <span class="text-primary text-3xl">⚖️</span>
          </div>
          <h3 class="text-xl font-bold text-primary mb-3">BMI 身体测评</h3>
          <p class="text-content mb-4 leading-relaxed">了解身体状况，建立健康认知</p>
          <div class="flex items-center justify-center text-sm text-gray-500">
            <span class="mr-2 text-mint">🕐</span>
            <span>约2分钟</span>
          </div>
        </div>
      </div>

      <!-- 身材焦虑自评卡片 -->
      <div class="assessment-card rounded-2xl p-8" onclick="window.location.href='assessment-test.html?type=anxiety'">
        <div class="text-center">
          <div class="icon-container w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-pink-100 to-pink-200 flex items-center justify-center">
            <span class="text-primary text-3xl">💖</span>
          </div>
          <h3 class="text-xl font-bold text-primary mb-3">身材焦虑自评</h3>
          <p class="text-content mb-4 leading-relaxed">9题量表，评估身材焦虑程度</p>
          <div class="flex items-center justify-center text-sm text-gray-500">
            <span class="mr-2 text-mint">🕐</span>
            <span>约3分钟</span>
          </div>
        </div>
      </div>
    </div>

    <!-- 历史记录 -->
    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
      <h4 class="text-lg font-semibold text-primary mb-4 flex items-center">
        <span class="mr-2 text-mint">📋</span>
        最近测评记录
      </h4>
      <div id="recentAssessments" class="space-y-3">
        <div class="text-content">暂无测评记录，开始你的第一次测评吧！</div>
      </div>
    </div>
  </main>

  <script>
    // 数据存储配置
    const DB_KEY = "mindfit_db_v1";
    
    const defaultDB = () => ({
      bmiAssessments: [],
      bodyAnxietyAssessments: [],
    });

    const loadDB = () => {
      try {
        const raw = localStorage.getItem(DB_KEY);
        return raw ? JSON.parse(raw) : defaultDB();
      } catch (e) {
        return defaultDB();
      }
    };

    const fmtTime = (ts) => {
      const d = new Date(ts);
      const pad = (n) => (n < 10 ? "0" + n : n);
      return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
    };

    // 渲染最近测评记录
    function renderRecentAssessments() {
      const db = loadDB();
      const container = document.getElementById('recentAssessments');
      
      const bmiTests = (db.bmiAssessments || []).map(test => ({
        type: 'BMI测评',
        ts: test.ts,
        result: `BMI: ${test.bmi} (${test.category})`,
        icon: '⚖️',
        color: 'text-blue-500'
      }));
      
      const anxietyTests = (db.bodyAnxietyAssessments || []).map(test => ({
        type: '身材焦虑自评',
        ts: test.ts,
        result: `得分: ${test.totalScore}/36 (${test.percentage}%)`,
        icon: '💖',
        color: 'text-pink-500'
      }));
      
      const allTests = [...bmiTests, ...anxietyTests]
        .sort((a, b) => b.ts - a.ts)
        .slice(0, 5);

      if (allTests.length === 0) {
        container.innerHTML = '<div class="text-content">暂无测评记录，开始你的第一次测评吧！</div>';
        return;
      }

      container.innerHTML = allTests.map(test => `
        <div class="flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0 history-item">
          <div class="flex items-center">
            <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center mr-3">
              <span class="${test.color}">${test.icon}</span>
            </div>
            <div>
              <div class="font-medium text-content">${test.type}</div>
              <div class="text-xs text-gray-500">${fmtTime(test.ts)}</div>
            </div>
          </div>
          <div class="text-sm text-gray-600 text-right">
            ${test.result}
          </div>
        </div>
      `).join('');
    }

    // 页面加载完成后的初始化
    document.addEventListener('DOMContentLoaded', function() {
      renderRecentAssessments();
    });
  </script>

</body>
</html>
