<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>日常练习 - MindFit</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" />
  
  <style>
    .practice-card {
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      cursor: pointer;
    }
    
    .practice-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }
     .page-content {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.2s forwards;
  }
  
  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* ✨ 新增:练习卡片渐入动画 */
  .practice-card {
    opacity: 0;
    transform: scale(0.92) translateY(20px);
    transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }
  
  .practice-card.animate-in {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
    
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: rgba(0, 0, 0, 0.85);
      color: white;
      padding: 12px 24px;
      border-radius: 25px;
      font-size: 14px;
      z-index: 1000;
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    
    .filter-btn.active {
      background: #4A6157;
      color: white;
    }
  </style>
</head>

<body class="bg-gray-50">
  
  <!-- Toast 提示 -->
  <div id="toast" class="toast"></div>

  <!-- 顶部导航 -->
  <nav class="bg-white shadow-sm sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center">
            <i class="fa fa-leaf text-white"></i>
          </div>
          <div>
            <h1 class="text-xl font-bold text-primary">日常练习</h1>
            <p class="text-xs text-gray-500">选择适合当前场景的练习</p>
          </div>
        </div>
        <a href="index.html" class="text-gray-600 hover:text-primary">
          <i class="fa fa-home text-xl"></i>
        </a>
      </div>
    </div>
  </nav>

  <main class="max-w-7xl mx-auto px-4 py-8">
    <div class="container page-content">

    <!-- 今日进度卡片 -->
    <div class="bg-white rounded-2xl p-6 shadow-sm mb-8">
      ...
    </div>

    <!-- 练习卡片网格 -->
    <div class="grid md:grid-cols-3 gap-6">
      <!-- 每个练习卡片保持原样 -->
      <div class="practice-card bg-white rounded-2xl p-6 shadow-sm" ...>
        ...
      </div>
    </div>

  </div>
</main>

      <!-- 今日进度卡片 -->
      <div class="bg-white rounded-2xl p-6 shadow-sm mb-8">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-xl font-semibold text-primary">今日练习进度</h2>
          <span class="text-sm text-gray-500" id="todayDate"></span>
        </div>
        
        <div class="grid md:grid-cols-3 gap-6">
          <div class="text-center">
            <div class="text-3xl font-bold text-primary mb-2" id="streakDays">0</div>
            <div class="text-sm text-gray-600">连续天数</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-mint mb-2" id="todayCompleted">0</div>
            <div class="text-sm text-gray-600">今日完成</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-accent mb-2" id="weekTotal">0</div>
            <div class="text-sm text-gray-600">本周总计</div>
          </div>
        </div>
      </div>

      <!-- 练习分类 -->
      <div class="mb-8">
        <div class="flex flex-wrap gap-3 justify-center">
          <button class="filter-btn active px-6 py-2 rounded-full bg-primary text-white font-medium transition-all" data-category="all">
            全部练习
          </button>
          <button class="filter-btn px-6 py-2 rounded-full bg-gray-200 text-gray-600 font-medium transition-all" data-category="body-neutral">
            🌿 身体中立专属
          </button>
          <button class="filter-btn px-6 py-2 rounded-full bg-gray-200 text-gray-600 font-medium transition-all" data-category="morning">
            🌅 晨间唤醒
          </button>
          <button class="filter-btn px-6 py-2 rounded-full bg-gray-200 text-gray-600 font-medium transition-all" data-category="work">
            💼 工作间隙
          </button>
          <button class="filter-btn px-6 py-2 rounded-full bg-gray-200 text-gray-600 font-medium transition-all" data-category="emotion">
            💫 情绪急救
          </button>
        </div>
      </div>

      <!-- 练习卡片网格 -->
      <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto" id="practiceGrid">
        <!-- 练习卡片将通过JavaScript动态生成 -->
      </div>

    </div>
  </main>

  <script>
    // ✨ 新增:页面加载时触发卡片动画
  document.addEventListener('DOMContentLoaded', function() {
    // 等待资源加载
    window.addEventListener('load', function() {
      setTimeout(() => {
        animatePracticeCards();
        updateDailyStats(); // 原有的统计更新函数
      }, 100);
    });
  });

  // ✨ 新增:练习卡片动画函数
  function animatePracticeCards() {
    const cards = document.querySelectorAll('.practice-card');
    
    cards.forEach((card, index) => {
      setTimeout(() => {
        card.classList.add('animate-in');
      }, index * 100); // 每张卡片延迟 100ms,形成层叠效果
    });
  }
    // ============================================
    // 练习数据 - 完整版本(15个练习)
    // ============================================
    const practiceData = [
      // ========== 身体中立专属练习(5个) ==========
      {
        id: 'mirror-kindness',
        title: '镜子友善练习',
        description: '用温柔的眼光看自己',
        category: 'body-neutral',
        duration: 5,
        difficulty: '简单',
        icon: 'fa-user-circle',
        color: 'bg-blue-100 text-blue-600',
        link: 'mirror-kindness.html',
        benefits: ['减少自我批评', '建立友善视角', '身体接纳']
      },
      {
        id: 'social-media-detox',
        title: '社交媒体清醒',
        description: '从比较中抽离,回到现实',
        category: 'body-neutral',
        duration: 3,
        difficulty: '简单',
        icon: 'fa-mobile',
        color: 'bg-cyan-100 text-cyan-600',
        link: 'social-media-detox.html',
        benefits: ['摆脱比较', '现实检验', '价值澄清']
      },
      {
        id: 'mindful-eating-light',
        title: '无罪感饮食',
        description: '食物无道德属性',
        category: 'body-neutral',
        duration: 5,
        difficulty: '简单',
        icon: 'fa-cutlery',
        color: 'bg-green-100 text-green-600',
        link: 'mindful-eating-light.html',
        benefits: ['减少罪恶感', '正念进食', '享受食物']
      },
      {
        id: 'exercise-mindset',
        title: '运动心态转换',
        description: '庆祝身体而非惩罚',
        category: 'body-neutral',
        duration: 3,
        difficulty: '简单',
        icon: 'fa-heartbeat',
        color: 'bg-orange-100 text-orange-600',
        link: 'exercise-mindset.html',
        benefits: ['改变运动动机', '减少惩罚心态', '享受运动']
      },
      {
        id: 'body-dialogue',
        title: '身体部位对话',
        description: '与身体和解',
        category: 'body-neutral',
        duration: 5,
        difficulty: '简单',
        icon: 'fa-heart',
        color: 'bg-pink-100 text-pink-600',
        link: 'body-dialogue.html',
        benefits: ['与身体和解', '感恩身体', '减少对抗']
      },

      // ========== 通用练习(10个) ==========
      {
        id: 'morning-breathing',
        title: '晨间觉醒呼吸',
        description: '用温柔的呼吸唤醒身体',
        category: 'morning',
        duration: 5,
        difficulty: '简单',
        icon: 'fa-sun-o',
        color: 'bg-yellow-100 text-yellow-600',
        link: 'morning-breathing.html',
        benefits: ['温柔唤醒', '提升专注', '开启活力']
      },
      {
        id: 'morning-stretch',
        title: '晨间拉伸',
        description: '感受身体的每个部分',
        category: 'morning',
        duration: 7,
        difficulty: '简单',
        icon: 'fa-hand-peace-o',
        color: 'bg-green-100 text-green-600',
        link: 'morning-stretch.html',
        benefits: ['身体觉察', '温柔对待', '建立连接']
      },
      {
        id: 'work-breathing',
        title: '办公室呼吸练习',
        description: '短暂休息,照顾疲惫的身体',
        category: 'work',
        duration: 3,
        difficulty: '简单',
        icon: 'fa-coffee',
        color: 'bg-blue-100 text-blue-600',
        link: 'work-breathing.html',
        benefits: ['快速恢复', '释放压力', '提升效率']
      },
      {
        id: 'evening-relax',
        title: '晚间放松',
        description: '温柔地结束一天',
        category: 'evening',
        duration: 10,
        difficulty: '简单',
        icon: 'fa-moon-o',
        color: 'bg-purple-100 text-purple-600',
        link: 'evening-relax.html',
        benefits: ['改善睡眠', '深度放松', '感恩身体']
      },
      {
        id: 'gratitude-practice',
        title: '感恩练习',
        description: '感谢身体的陪伴',
        category: 'emotion',
        duration: 5,
        difficulty: '简单',
        icon: 'fa-gift',
        color: 'bg-pink-100 text-pink-600',
        link: 'gratitude-practice.html',
        benefits: ['培养感恩', '积极心态', '幸福感提升']
      },
      {
        id: 'walking-meditation',
        title: '行走冥想',
        description: '在行走中觉察',
        category: 'emotion',
        duration: 10,
        difficulty: '简单',
        icon: 'fa-street-view',
        color: 'bg-teal-100 text-teal-600',
        link: 'walking-meditation.html',
        benefits: ['身心合一', '当下觉察', '压力释放']
      },
      {
        id: 'self-compassion',
        title: '自我慈悲',
        description: '像对待朋友一样对待自己',
        category: 'emotion',
        duration: 8,
        difficulty: '中等',
        icon: 'fa-heart-o',
        color: 'bg-rose-100 text-rose-600',
        link: 'self-compassion.html',
        benefits: ['自我接纳', '减少批判', '内在和平']
      },
      {
        id: 'quick-calm',
        title: '快速平静',
        description: '紧急情况下的情绪急救',
        category: 'emotion',
        duration: 3,
        difficulty: '简单',
        icon: 'fa-bolt',
        color: 'bg-red-100 text-red-600',
        link: 'quick-calm.html',
        benefits: ['快速冷静', '应急处理', '恢复理智']
      },
      {
        id: 'sleep-preparation',
        title: '睡前放松',
        description: '为优质睡眠做准备',
        category: 'evening',
        duration: 12,
        difficulty: '简单',
        icon: 'fa-bed',
        color: 'bg-indigo-100 text-indigo-600',
        link: 'sleep-preparation.html',
        benefits: ['助眠', '深度放松', '改善睡眠质量']
      },
      {
        id: 'energy-boost',
        title: '能量提升',
        description: '快速恢复精力',
        category: 'work',
        duration: 5,
        difficulty: '简单',
        icon: 'fa-flash',
        color: 'bg-amber-100 text-amber-600',
        link: 'energy-boost.html',
        benefits: ['恢复活力', '提升专注', '战胜疲惫']
      }
    ];

    // 全局变量
    let practiceHistory = [];

    // ============================================
    // 核心功能
    // ============================================

    // 渲染练习卡片
    function renderPracticeCards(filterCategory = 'all') {
      const grid = document.getElementById('practiceGrid');
      grid.innerHTML = '';
      
      const filteredPractices = filterCategory === 'all' 
        ? practiceData 
        : practiceData.filter(p => p.category === filterCategory);
      
      filteredPractices.forEach(practice => {
        const card = createPracticeCard(practice);
        grid.appendChild(card);
      });
    }

    // 创建练习卡片
    function createPracticeCard(practice) {
      const card = document.createElement('div');
      card.className = 'practice-card bg-white rounded-2xl p-6 shadow-sm';
      card.onclick = () => startPractice(practice);
      
      card.innerHTML = `
        <div class="flex items-start justify-between mb-4">
          <div class="w-12 h-12 ${practice.color} rounded-xl flex items-center justify-center">
            <i class="fa ${practice.icon} text-2xl"></i>
          </div>
          <span class="text-xs bg-gray-100 px-3 py-1 rounded-full text-gray-600">
            ${practice.duration}分钟
          </span>
        </div>
        
        <h3 class="text-lg font-bold text-gray-800 mb-2">${practice.title}</h3>
        <p class="text-sm text-gray-600 mb-4">${practice.description}</p>
        
        <div class="flex flex-wrap gap-2 mb-4">
          ${practice.benefits.map(benefit => 
            `<span class="text-xs bg-gray-50 px-2 py-1 rounded text-gray-600">${benefit}</span>`
          ).join('')}
        </div>
        
        <div class="flex items-center justify-between text-xs text-gray-500">
          <span><i class="fa fa-signal mr-1"></i>${practice.difficulty}</span>
          <span class="text-primary font-medium">开始练习 →</span>
        </div>
      `;
      
      return card;
    }

    // 开始练习
    function startPractice(practice) {
      showToast(`正在打开 ${practice.title}...`);
      
      // 记录练习开始
      const startRecord = {
        practiceId: practice.id,
        startTime: Date.now()
      };
      sessionStorage.setItem('currentPractice', JSON.stringify(startRecord));
      
      // 延迟跳转以显示提示
      setTimeout(() => {
        window.location.href = practice.link;
      }, 500);
    }

    // 显示Toast提示
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 2500);
    }

    // ============================================
    // 统计功能
    // ============================================

    // 加载练习历史
    function loadPracticeHistory() {
      try {
        const history = localStorage.getItem('practiceHistory');
        practiceHistory = history ? JSON.parse(history) : [];
      } catch (e) {
        practiceHistory = [];
      }
    }

    // 更新今日统计
    function updateTodayStats() {
      const today = new Date().toDateString();
      const todayPractices = practiceHistory.filter(p => 
        new Date(p.date).toDateString() === today
      );
      
      document.getElementById('todayCompleted').textContent = todayPractices.length;
      
      // 计算连续天数
      const streak = calculateStreak();
      document.getElementById('streakDays').textContent = streak;
      
      // 本周总计
      const weekTotal = calculateWeekTotal();
      document.getElementById('weekTotal').textContent = weekTotal;
    }

    // 计算连续天数
    function calculateStreak() {
      if (practiceHistory.length === 0) return 0;
      
      const today = new Date();
      today.setHours(0, 0, 0, 0);
      
      let streak = 0;
      let currentDate = new Date(today);
      
      for (let i = 0; i < 365; i++) {
        const dateStr = currentDate.toDateString();
        const hasPractice = practiceHistory.some(p => 
          new Date(p.date).toDateString() === dateStr
        );
        
        if (hasPractice) {
          streak++;
        } else if (i > 0) {
          break;
        }
        
        currentDate.setDate(currentDate.getDate() - 1);
      }
      
      return streak;
    }

    // 计算本周总数
    function calculateWeekTotal() {
      const now = new Date();
      const startOfWeek = new Date(now);
      startOfWeek.setDate(now.getDate() - now.getDay());
      startOfWeek.setHours(0, 0, 0, 0);
      
      return practiceHistory.filter(p => 
        new Date(p.date) >= startOfWeek
      ).length;
    }

    // 设置今日日期
    function setTodayDate() {
      const today = new Date();
      const options = { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric',
        weekday: 'long'
      };
      document.getElementById('todayDate').textContent = 
        today.toLocaleDateString('zh-CN', options);
    }

    // ============================================
    // 分类过滤
    // ============================================

    function initCategoryFilter() {
      const filterBtns = document.querySelectorAll('.filter-btn');
      
      filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          // 移除所有active类
          filterBtns.forEach(b => {
            b.classList.remove('active');
            b.classList.remove('bg-primary', 'text-white');
            b.classList.add('bg-gray-200', 'text-gray-600');
          });
          
          // 添加active类到当前按钮
          btn.classList.add('active');
          btn.classList.remove('bg-gray-200', 'text-gray-600');
          btn.classList.add('bg-primary', 'text-white');
          
          // 渲染对应分类的卡片
          const category = btn.dataset.category;
          renderPracticeCards(category);
        });
      });
    }

    // ============================================
    // 页面初始化
    // ============================================

    document.addEventListener('DOMContentLoaded', () => {
      loadPracticeHistory();
      setTodayDate();
      updateTodayStats();
      renderPracticeCards();
      initCategoryFilter();
      
      // 欢迎提示
      setTimeout(() => {
        showToast('欢迎来到日常练习！选择一个适合的练习开始吧 🌿');
      }, 1000);
    });

    // Tailwind配置
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: "#4A6157",
            mint: "#8FD9A8",
            accent: "#2E2E2E"
          }
        }
      }
    };
  </script>

</body>
</html>
