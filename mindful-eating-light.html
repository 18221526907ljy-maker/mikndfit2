<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ— ç½ªæ„Ÿé¥®é£Ÿç»ƒä¹  - MindFit</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; }
    .food-float { animation: foodFloat 3s ease-in-out infinite; }
    @keyframes foodFloat {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(5deg); }
    }
    .fade-in { animation: fadeIn 0.8s ease-in; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .gentle-pulse { animation: gentlePulse 2s ease-in-out infinite; }
    @keyframes gentlePulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-green-50 via-lime-50 to-yellow-50 min-h-screen">
  
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <nav class="bg-white/80 backdrop-blur-sm shadow-sm sticky top-0 z-50">
    <div class="max-w-4xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="daily_practice.html" class="text-green-600 hover:text-green-700">
        <i class="fas fa-arrow-left mr-2"></i>è¿”å›ç»ƒä¹ 
      </a>
      <h1 class="text-lg font-semibold text-gray-800">æ— ç½ªæ„Ÿé¥®é£Ÿç»ƒä¹ </h1>
      <div class="w-20"></div>
    </div>
  </nav>

  <!-- ä¸»è¦å†…å®¹ -->
  <main class="max-w-4xl mx-auto px-4 py-8">
    
    <!-- å¼•è¨€å¡ç‰‡ -->
    <div class="bg-white rounded-3xl shadow-lg p-8 mb-8">
      <div class="text-center mb-6">
        <div class="food-float w-24 h-24 bg-gradient-to-br from-green-400 to-lime-500 rounded-full mx-auto mb-4 flex items-center justify-center">
          <i class="fas fa-utensils text-4xl text-white"></i>
        </div>
        <h2 class="text-3xl font-bold text-gray-800 mb-3">é£Ÿç‰©æ˜¯ä¸­æ€§çš„,æ²¡æœ‰"ä½œå¼Šé¤"</h2>
        <p class="text-gray-600 text-lg">5åˆ†é’Ÿå­¦ä¼šäº«å—é£Ÿç‰©,è€Œéææƒ§å®ƒ</p>
      </div>

      <div class="grid md:grid-cols-3 gap-4 mb-6">
        <div class="text-center p-4 bg-green-50 rounded-xl">
          <i class="fas fa-clock text-green-600 text-2xl mb-2"></i>
          <div class="text-sm text-gray-600">ç»ƒä¹ æ—¶é•¿</div>
          <div class="text-lg font-semibold text-gray-800">5åˆ†é’Ÿ</div>
        </div>
        <div class="text-center p-4 bg-lime-50 rounded-xl">
          <i class="fas fa-calendar-day text-lime-600 text-2xl mb-2"></i>
          <div class="text-sm text-gray-600">ä½•æ—¶ä½¿ç”¨</div>
          <div class="text-lg font-semibold text-gray-800">é¥®é£Ÿå‰/å</div>
        </div>
        <div class="text-center p-4 bg-yellow-50 rounded-xl">
          <i class="fas fa-heart text-yellow-600 text-2xl mb-2"></i>
          <div class="text-sm text-gray-600">ä¸»è¦æ•ˆæœ</div>
          <div class="text-lg font-semibold text-gray-800">å‡å°‘ç½ªæ¶æ„Ÿ</div>
        </div>
      </div>

      <div class="bg-gradient-to-r from-green-50 to-lime-50 rounded-2xl p-6">
        <h3 class="font-bold text-gray-800 mb-3 flex items-center text-lg">
          <i class="fas fa-exclamation-circle text-green-600 mr-3"></i>
          è¿™ä¸ªç»ƒä¹ ç‰¹åˆ«é€‚åˆä½ ,å¦‚æœ...
        </h3>
        <ul class="space-y-2 text-gray-700">
          <li class="flex items-start">
            <i class="fas fa-check text-green-600 mr-2 mt-1"></i>
            <span>åƒ"ä¸å¥åº·"é£Ÿç‰©åæ„Ÿåˆ°å¼ºçƒˆç½ªæ¶æ„Ÿ</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-600 mr-2 mt-1"></i>
            <span>æŠŠé£Ÿç‰©åˆ†ä¸º"å¥½é£Ÿç‰©"å’Œ"åé£Ÿç‰©"</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-600 mr-2 mt-1"></i>
            <span>ç»å¸¸å› ä¸ºåƒäº†ä»€ä¹ˆè€Œè‡ªè´£æˆ–æƒ©ç½šè‡ªå·±</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-600 mr-2 mt-1"></i>
            <span>æƒ³å»ºç«‹æ›´å¥åº·ã€æ›´è‡ªç”±çš„é¥®é£Ÿå…³ç³»</span>
          </li>
        </ul>
      </div>
    </div>

    <!-- æ‰“ç ´äºŒå…ƒæ€ç»´ -->
    <div class="bg-white rounded-3xl shadow-lg p-8 mb-8">
      <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
        <i class="fas fa-ban text-red-600 mr-3"></i>
        æ‰“ç ´"å¥½vså"çš„äºŒå…ƒæ€ç»´
      </h3>
      
      <div class="grid md:grid-cols-2 gap-6 mb-6">
        <div class="bg-red-50 border-2 border-red-200 rounded-xl p-6">
          <h4 class="font-bold text-red-700 mb-4 text-center">âŒ æœ‰å®³çš„é¥®é£Ÿæ€ç»´</h4>
          <ul class="space-y-2 text-sm text-gray-700">
            <li class="flex items-start">
              <i class="fas fa-times-circle text-red-500 mr-2 mt-1"></i>
              <span>"æ²™æ‹‰æ˜¯å¥½çš„,è›‹ç³•æ˜¯åçš„"</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-times-circle text-red-500 mr-2 mt-1"></i>
              <span>"æˆ‘ä»Šå¤©åƒäº†è›‹ç³•,æˆ‘ä½œå¼Šäº†"</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-times-circle text-red-500 mr-2 mt-1"></i>
              <span>"æˆ‘éœ€è¦é€šè¿‡è¿åŠ¨'æƒ©ç½š'è‡ªå·±"</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-times-circle text-red-500 mr-2 mt-1"></i>
              <span>"åƒäº†ç¢³æ°´åŒ–åˆç‰©,æˆ‘ä¼šå˜èƒ–"</span>
            </li>
          </ul>
        </div>

        <div class="bg-green-50 border-2 border-green-200 rounded-xl p-6">
          <h4 class="font-bold text-green-700 mb-4 text-center">âœ… å¥åº·çš„é¥®é£Ÿæ€ç»´</h4>
          <ul class="space-y-2 text-sm text-gray-700">
            <li class="flex items-start">
              <i class="fas fa-check-circle text-green-500 mr-2 mt-1"></i>
              <span>"æ‰€æœ‰é£Ÿç‰©éƒ½èƒ½æä¾›èƒ½é‡å’Œè¥å…»"</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check-circle text-green-500 mr-2 mt-1"></i>
              <span>"æˆ‘ä»Šå¤©åƒäº†è›‹ç³•,äº«å—äº†ç¾å‘³"</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check-circle text-green-500 mr-2 mt-1"></i>
              <span>"è¿åŠ¨æ˜¯åº†ç¥èº«ä½“,ä¸æ˜¯æƒ©ç½š"</span>
            </li>
            <li class="flex items-start">
              <i class="fas fa-check-circle text-green-500 mr-2 mt-1"></i>
              <span>"å¹³è¡¡å’Œå¤šæ ·æ€§æ¯”'å®Œç¾'æ›´é‡è¦"</span>
            </li>
          </ul>
        </div>
      </div>

      <div class="bg-blue-50 border-l-4 border-blue-400 rounded-r-xl p-4">
        <p class="text-sm text-gray-700">
          <i class="fas fa-lightbulb text-blue-600 mr-2"></i>
          <strong>æ ¸å¿ƒç†å¿µ:</strong> é£Ÿç‰©æ²¡æœ‰é“å¾·å±æ€§ã€‚åƒè›‹ç³•ä¸ä¼šè®©ä½ æˆä¸º"åäºº",åƒæ²™æ‹‰ä¸ä¼šè®©ä½ æˆä¸º"å¥½äºº"ã€‚é£Ÿç‰©å°±æ˜¯é£Ÿç‰©,å®ƒå­˜åœ¨æ˜¯ä¸ºäº†æ»‹å…»å’Œæ„‰æ‚¦ä½ ,è€Œéè¯„åˆ¤ä½ ã€‚
        </p>
      </div>
    </div>

    <!-- å¼€å§‹ç»ƒä¹ æŒ‰é’® -->
    <div class="text-center mb-8">
      <div class="mb-4">
        <p class="text-gray-600 mb-2">é€‰æ‹©ç»ƒä¹ æ—¶æœº:</p>
        <div class="flex gap-3 justify-center flex-wrap">
          <button onclick="startPractice('before')" class="bg-green-100 hover:bg-green-200 text-green-700 px-6 py-3 rounded-xl font-medium transition-all">
            <i class="fas fa-clock mr-2"></i>é¥®é£Ÿå‰
          </button>
          <button onclick="startPractice('during')" class="bg-lime-100 hover:bg-lime-200 text-lime-700 px-6 py-3 rounded-xl font-medium transition-all">
            <i class="fas fa-utensils mr-2"></i>é¥®é£Ÿä¸­
          </button>
          <button onclick="startPractice('after')" class="bg-yellow-100 hover:bg-yellow-200 text-yellow-700 px-6 py-3 rounded-xl font-medium transition-all">
            <i class="fas fa-check mr-2"></i>é¥®é£Ÿå
          </button>
        </div>
      </div>
    </div>

    <!-- å¸¸è§ç½ªæ¶æ„Ÿåœºæ™¯ -->
    <div class="bg-white rounded-3xl shadow-lg p-8">
      <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
        <i class="fas fa-question-circle text-purple-600 mr-3"></i>
        å¸¸è§ç½ªæ¶æ„Ÿåœºæ™¯åº”å¯¹
      </h3>
      
      <div class="space-y-4">
        <details class="bg-purple-50 rounded-xl p-4">
          <summary class="font-semibold text-gray-800 cursor-pointer">
            åœºæ™¯1: "æˆ‘åƒäº†ç”œé£Ÿ/æ²¹ç‚¸é£Ÿå“,æ„Ÿè§‰å¾ˆç³Ÿç³•"
          </summary>
          <p class="text-sm text-gray-600 mt-3 pl-4">
            <strong>åº”å¯¹:</strong> æé†’è‡ªå·±,è¿™åªæ˜¯ä¸€é¤/ä¸€æ¬¡é›¶é£Ÿ,ä¸ä¼šæ”¹å˜ä½ çš„æ•´ä½“å¥åº·ã€‚ä½ çš„èº«ä½“å¾ˆèªæ˜,ä¼šå¤„ç†å„ç§é£Ÿç‰©ã€‚äº«å—å½“ä¸‹,ç„¶åç»§ç»­æ­£å¸¸é¥®é£Ÿã€‚
          </p>
        </details>

        <details class="bg-purple-50 rounded-xl p-4">
          <summary class="font-semibold text-gray-800 cursor-pointer">
            åœºæ™¯2: "æˆ‘åƒå¤šäº†,éœ€è¦èŠ‚é£Ÿ/è¿åŠ¨è¡¥å¿"
          </summary>
          <p class="text-sm text-gray-600 mt-3 pl-4">
            <strong>åº”å¯¹:</strong> åƒå¤šäº†æ˜¯æ­£å¸¸çš„,æ¯ä¸ªäººéƒ½ä¼šã€‚ä¸éœ€è¦"è¡¥å¿"æˆ–"æƒ©ç½š"ã€‚ä¸‹ä¸€é¤æ­£å¸¸åƒ,å¬ä»èº«ä½“çš„é¥¥é¥¿ä¿¡å·,è€Œéå¤§è„‘çš„ç½ªæ¶æ„Ÿã€‚
          </p>
        </details>

        <details class="bg-purple-50 rounded-xl p-4">
          <summary class="font-semibold text-gray-800 cursor-pointer">
            åœºæ™¯3: "åˆ«äººéƒ½åœ¨å‡è‚¥/èŠ‚é£Ÿ,æˆ‘åº”è¯¥ä¹Ÿè¿™æ ·"
          </summary>
          <p class="text-sm text-gray-600 mt-3 pl-4">
            <strong>åº”å¯¹:</strong> æ¯ä¸ªäººçš„èº«ä½“å’Œéœ€æ±‚ä¸åŒã€‚é¥®é£Ÿæ–‡åŒ–å¸¸å¸¸æœ‰å®³ä¸”ä¸ç§‘å­¦ã€‚ç›¸ä¿¡ä½ çš„èº«ä½“,å®ƒçŸ¥é“è‡ªå·±éœ€è¦ä»€ä¹ˆã€‚
          </p>
        </details>

        <details class="bg-purple-50 rounded-xl p-4">
          <summary class="font-semibold text-gray-800 cursor-pointer">
            åœºæ™¯4: "æˆ‘ä¸€æ•´å¤©éƒ½åœ¨æƒ³é£Ÿç‰©,æˆ‘æ˜¯ä¸æ˜¯æœ‰é—®é¢˜?"
          </summary>
          <p class="text-sm text-gray-600 mt-3 pl-4">
            <strong>åº”å¯¹:</strong> è¿‡åº¦é™åˆ¶ä¼šå¯¼è‡´é£Ÿç‰©æ‰§å¿µã€‚å½“ä½ ç»™è‡ªå·±"åƒçš„è‡ªç”±",é£Ÿç‰©ä¼šå¤±å»ç¥ç§˜æ„Ÿ,æ‰§å¿µä¼šå‡å°‘ã€‚è¿™æ˜¯æ­£å¸¸çš„ç”Ÿç†å’Œå¿ƒç†ååº”ã€‚
          </p>
        </details>
      </div>
    </div>

  </main>

  <!-- ç»ƒä¹ æ¨¡æ€æ¡† -->
  <div id="practiceModal" class="hidden fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-3xl shadow-2xl max-w-lg w-full p-8">
      
      <!-- è¿›åº¦æ˜¾ç¤º -->
      <div class="text-center mb-6">
        <div id="stepIndicator" class="text-sm text-gray-500 mb-2">æ­¥éª¤ 1/4</div>
        <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
          <div id="progressBar" class="bg-gradient-to-r from-green-500 to-lime-500 h-2 rounded-full transition-all duration-500" style="width: 25%"></div>
        </div>
      </div>

      <!-- å½“å‰æ­¥éª¤å›¾æ ‡ -->
      <div class="text-center mb-6">
        <div id="stepIcon" class="w-20 h-20 bg-green-100 rounded-full mx-auto mb-4 flex items-center justify-center fade-in">
          <i class="fas fa-heart text-3xl text-green-600"></i>
        </div>
      </div>

      <!-- å¼•å¯¼å†…å®¹ -->
      <div id="guideContent" class="text-center mb-8 min-h-[200px]">
        <h3 id="guideTitle" class="text-2xl font-bold text-gray-800 mb-4 fade-in">è§‰å¯Ÿé¥¥é¥¿</h3>
        <p id="guideText" class="text-gray-600 leading-relaxed fade-in">
          åœä¸‹æ¥,é—®é—®è‡ªå·±:æˆ‘çœŸçš„é¥¿å—?è¿˜æ˜¯å› ä¸ºæ— èŠã€ç„¦è™‘ã€ä¹ æƒ¯?æ— è®ºç­”æ¡ˆæ˜¯ä»€ä¹ˆ,éƒ½æ²¡å…³ç³»,åªæ˜¯è§‰å¯Ÿã€‚
        </p>
      </div>

      <!-- è®¡æ—¶å™¨ -->
      <div class="text-center mb-6">
        <div id="timer" class="text-4xl font-bold text-green-600">0:00</div>
        <div class="text-sm text-gray-500 mt-1">æœ¬æ­¥éª¤å€’è®¡æ—¶</div>
      </div>

      <!-- æ§åˆ¶æŒ‰é’® -->
      <div class="flex gap-3">
        <button onclick="skipStep()" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 rounded-xl font-medium transition-all">
          <i class="fas fa-forward mr-2"></i>è·³è¿‡
        </button>
        <button id="pauseBtn" onclick="togglePause()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-medium transition-all">
          <i class="fas fa-pause mr-2"></i>æš‚åœ
        </button>
      </div>

    </div>
  </div>

  <!-- å®Œæˆæ¨¡æ€æ¡† -->
  <div id="completionModal" class="hidden fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-3xl shadow-2xl max-w-lg w-full p-8">
      
      <div class="text-center mb-6">
        <div class="w-24 h-24 bg-green-100 rounded-full mx-auto mb-4 flex items-center justify-center">
          <i class="fas fa-check-circle text-5xl text-green-600"></i>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-2">ğŸ‰ ç»ƒä¹ å®Œæˆ!</h3>
        <p class="text-gray-600">ä½ åˆšåˆšç»ƒä¹ äº†æ— ç½ªæ„Ÿé¥®é£Ÿ</p>
      </div>

      <div class="bg-gradient-to-r from-green-50 to-lime-50 rounded-2xl p-6 mb-6">
        <h4 class="font-semibold text-gray-800 mb-3">ğŸ’¡ è®°ä½è¿™äº›:</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start">
            <i class="fas fa-star text-green-600 mr-2 mt-1"></i>
            <span>é£Ÿç‰©æ²¡æœ‰é“å¾·å±æ€§,åƒä»€ä¹ˆä¸ä¼šå®šä¹‰ä½ çš„ä»·å€¼</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-star text-green-600 mr-2 mt-1"></i>
            <span>èº«ä½“ä¼šè‡ªæˆ‘è°ƒèŠ‚,ä¸€é¤åƒå¤š/å°‘éƒ½ä¸ä¼šæ”¹å˜æ•´ä½“å¥åº·</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-star text-green-600 mr-2 mt-1"></i>
            <span>äº«å—é£Ÿç‰©æ˜¯äººçš„æƒåˆ©,ä¸éœ€è¦"èµšå–"æˆ–"è¡¥å¿"</span>
          </li>
        </ul>
      </div>

      <div class="bg-purple-50 border-2 border-purple-200 rounded-xl p-4 mb-6">
        <h4 class="font-semibold text-gray-800 mb-2 flex items-center">
          <i class="fas fa-tools text-purple-600 mr-2"></i>
          æƒ³è¦æ›´æ·±å…¥çš„æ”¹å˜?
        </h4>
        <p class="text-sm text-gray-600 mb-3">
          è¯•è¯•<strong>"é¥®é£Ÿä¸æƒ…ç»ªæ—¥å¿—"</strong>,å¯ä»¥å¸®ä½ è¯†åˆ«æƒ…ç»ªåŒ–è¿›é£Ÿæ¨¡å¼,å»ºç«‹æ›´å¥åº·çš„é¥®é£Ÿå…³ç³»ã€‚
        </p>
        <button onclick="goToTool()" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg text-sm font-medium transition-all">
          <i class="fas fa-arrow-right mr-2"></i>å‰å¾€æ·±åº¦å·¥å…·
        </button>
      </div>

      <button onclick="closeCompletion()" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 rounded-xl font-medium transition-all">
        å®Œæˆå¹¶è¿”å›
      </button>

    </div>
  </div>

  <script>
    let currentStep = 0;
    let timer = null;
    let remainingSeconds = 0;
    let isPaused = false;
    let totalTime = 0;
    let practiceMode = 'before'; // before, during, after

    const stepsByMode = {
      before: [
        {
          title: 'è§‰å¯Ÿé¥¥é¥¿',
          icon: 'fa-heart',
          iconColor: 'green',
          text: 'åœä¸‹æ¥,é—®é—®è‡ªå·±:æˆ‘çœŸçš„é¥¿å—?è¿˜æ˜¯å› ä¸ºæ— èŠã€ç„¦è™‘ã€ä¹ æƒ¯?æ— è®ºç­”æ¡ˆæ˜¯ä»€ä¹ˆ,éƒ½æ²¡å…³ç³»,åªæ˜¯è§‰å¯Ÿã€‚',
          duration: 40
        },
        {
          title: 'é‡Šæ”¾æœŸå¾…',
          icon: 'fa-unlock',
          iconColor: 'lime',
          text: 'æé†’è‡ªå·±:è¿™ä¸æ˜¯"ä½œå¼Šé¤"æˆ–"å¥–åŠ±"ã€‚é£Ÿç‰©å°±æ˜¯é£Ÿç‰©,å®ƒå­˜åœ¨æ˜¯ä¸ºäº†æ»‹å…»ä½ ã€‚ä½ ä¸éœ€è¦"èµšå–"åƒçš„æƒåˆ©ã€‚',
          duration: 50
        },
        {
          title: 'è®¾å®šæ„å›¾',
          icon: 'fa-bullseye',
          iconColor: 'yellow',
          text: 'åœ¨å¿ƒä¸­é»˜å¿µ:æˆ‘å…è®¸è‡ªå·±äº«å—è¿™é¤é£Ÿç‰©ã€‚æˆ‘ä¼šä¸“æ³¨å“å°,è€Œéè¯„åˆ¤è‡ªå·±ã€‚åƒå®Œå,æˆ‘ä¼šæ¸©æŸ”åœ°å¯¹å¾…è‡ªå·±ã€‚',
          duration: 50
        },
        {
          title: 'å¼€å§‹äº«ç”¨',
          icon: 'fa-smile',
          iconColor: 'green',
          text: 'æ·±å‘¼å¸,å¾®ç¬‘ã€‚å‡†å¤‡å¥½äº«å—é£Ÿç‰©äº†ã€‚è®°ä½:æ— è®ºåƒä»€ä¹ˆ,éƒ½ä¸ä¼šæ”¹å˜ä½ çš„ä»·å€¼ã€‚',
          duration: 40
        }
      ],
      
      during: [
        {
          title: 'æ”¾æ…¢é€Ÿåº¦',
          icon: 'fa-pause',
          iconColor: 'green',
          text: 'åƒåˆ°ä¸€åŠ,æš‚åœå‡ ç§’é’Ÿã€‚è§‚å¯Ÿé£Ÿç‰©çš„é¢œè‰²ã€é—»é—»é¦™å‘³ã€æ„Ÿå—è´¨åœ°ã€‚åƒå¾—æ…¢ä¸€äº›,è®©å¤§è„‘æœ‰æ—¶é—´æ¥æ”¶æ»¡è¶³çš„ä¿¡å·ã€‚',
          duration: 50
        },
        {
          title: 'ä¸“æ³¨å½“ä¸‹',
          icon: 'fa-eye',
          iconColor: 'lime',
          text: 'æŠŠæ³¨æ„åŠ›å¸¦å›åˆ°é£Ÿç‰©ä¸Šã€‚å¦‚æœæ€ç»ªé£˜åˆ°"æˆ‘ä¸è¯¥åƒè¿™ä¸ª"ã€"æˆ‘è¦èƒ–äº†",æ¸©æŸ”åœ°æé†’è‡ªå·±:ç°åœ¨åªéœ€è¦ä¸“æ³¨äºå“å°ã€‚',
          duration: 50
        },
        {
          title: 'æ„Ÿå—èº«ä½“',
          icon: 'fa-heart-pulse',
          iconColor: 'yellow',
          text: 'é—®é—®èº«ä½“:æˆ‘ç°åœ¨çš„é¥±è…¹æ„Ÿå¦‚ä½•?è¿˜éœ€è¦æ›´å¤šé£Ÿç‰©å—?å°Šé‡èº«ä½“çš„ä¿¡å·,æ— è®ºæ˜¯ç»§ç»­åƒè¿˜æ˜¯åœä¸‹æ¥ã€‚',
          duration: 40
        },
        {
          title: 'äº«å—è¿‡ç¨‹',
          icon: 'fa-smile',
          iconColor: 'green',
          text: 'æé†’è‡ªå·±:åƒä¸œè¥¿æ˜¯å¯ä»¥äº«å—çš„ã€‚ä¸éœ€è¦åœ¨è„‘æµ·ä¸­è®¡ç®—å¡è·¯é‡Œæˆ–æ„Ÿåˆ°å†…ç–šã€‚æ­¤åˆ»,åªæ˜¯äº«å—ã€‚',
          duration: 40
        }
      ],
      
      after: [
        {
          title: 'æ„Ÿè°¢èº«ä½“',
          icon: 'fa-hands-praying',
          iconColor: 'green',
          text: 'æ„Ÿè°¢ä½ çš„èº«ä½“å’Œè¿™é¡¿é£Ÿç‰©ã€‚ä½ çš„èƒƒä¼šæ¶ˆåŒ–å®ƒ,è½¬åŒ–ä¸ºèƒ½é‡,æ»‹å…»ä½ çš„ç»†èƒã€‚è¿™æ˜¯èº«ä½“è‡ªç„¶çš„å·¥ä½œ,ä¸éœ€è¦ä½ æ‹…å¿ƒã€‚',
          duration: 50
        },
        {
          title: 'æ”¾ä¸‹è¯„åˆ¤',
          icon: 'fa-feather',
          iconColor: 'lime',
          text: 'å¦‚æœç½ªæ¶æ„Ÿå†’å‡ºæ¥,æƒ³è±¡æŠŠå®ƒå†™åœ¨ä¸€ç‰‡å¶å­ä¸Š,çœ‹ç€å®ƒé£˜èµ°ã€‚å¯¹è‡ªå·±è¯´:"æˆ‘åƒäº†é£Ÿç‰©,å°±è¿™æ ·ã€‚æˆ‘ä¸éœ€è¦è¡¥å¿æˆ–æƒ©ç½šè‡ªå·±ã€‚"',
          duration: 60
        },
        {
          title: 'ç»§ç»­ç”Ÿæ´»',
          icon: 'fa-forward',
          iconColor: 'yellow',
          text: 'è¿™åªæ˜¯ä¸€é¤,ä¸ä¼šå®šä¹‰ä½ çš„ä¸€å¤©ã€ä¸€å‘¨ã€æˆ–ä½ çš„å¥åº·ã€‚ä¸‹ä¸€é¤æ­£å¸¸åƒ,å¬ä»èº«ä½“çš„ä¿¡å·ã€‚ä½ çš„èº«ä½“çŸ¥é“å¦‚ä½•å¹³è¡¡ã€‚',
          duration: 50
        },
        {
          title: 'è‡ªæˆ‘å…³æ€€',
          icon: 'fa-heart',
          iconColor: 'green',
          text: 'å¯¹è‡ªå·±è¯´ä¸€å¥æ¸©æŸ”çš„è¯:"æˆ‘å€¼å¾—äº«å—é£Ÿç‰©ã€‚""æˆ‘çš„ä»·å€¼ä¸ç”±åƒä»€ä¹ˆå†³å®šã€‚""æˆ‘å¯¹è‡ªå·±å¾ˆæ¸©æŸ”ã€‚"',
          duration: 20
        }
      ]
    };

    function startPractice(mode) {
      practiceMode = mode;
      document.getElementById('practiceModal').classList.remove('hidden');
      currentStep = 0;
      totalTime = 0;
      renderStep();
    }

    function renderStep() {
      const steps = stepsByMode[practiceMode];
      const step = steps[currentStep];
      
      // æ›´æ–°è¿›åº¦
      const progress = ((currentStep + 1) / steps.length) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      document.getElementById('stepIndicator').textContent = `æ­¥éª¤ ${currentStep + 1}/${steps.length}`;

      // æ›´æ–°å›¾æ ‡
      const iconColors = {
        green: 'bg-green-100 text-green-600',
        lime: 'bg-lime-100 text-lime-600',
        yellow: 'bg-yellow-100 text-yellow-600'
      };
      
      const iconDiv = document.getElementById('stepIcon');
      iconDiv.className = `w-20 h-20 ${iconColors[step.iconColor]} rounded-full mx-auto mb-4 flex items-center justify-center fade-in`;
      iconDiv.innerHTML = `<i class="fas ${step.icon} text-3xl"></i>`;

      // æ›´æ–°æ–‡å­—
      document.getElementById('guideTitle').textContent = step.title;
      document.getElementById('guideText').textContent = step.text;

      // å¼€å§‹è®¡æ—¶
      remainingSeconds = step.duration;
      isPaused = false;
      updateTimer();
      startTimer();
    }

    function startTimer() {
      clearInterval(timer);
      timer = setInterval(() => {
        if (!isPaused && remainingSeconds > 0) {
          remainingSeconds--;
          totalTime++;
          updateTimer();
          
          if (remainingSeconds === 0) {
            nextStep();
          }
        }
      }, 1000);
    }

    function updateTimer() {
      const minutes = Math.floor(remainingSeconds / 60);
      const seconds = remainingSeconds % 60;
      document.getElementById('timer').textContent = 
        `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    function nextStep() {
      const steps = stepsByMode[practiceMode];
      if (currentStep < steps.length - 1) {
        currentStep++;
        renderStep();
      } else {
        completePractice();
      }
    }

    function skipStep() {
      nextStep();
    }

    function togglePause() {
      isPaused = !isPaused;
      const btn = document.getElementById('pauseBtn');
      btn.innerHTML = isPaused ? 
        '<i class="fas fa-play mr-2"></i>ç»§ç»­' : 
        '<i class="fas fa-pause mr-2"></i>æš‚åœ';
    }

    function completePractice() {
      clearInterval(timer);
      
      // ä¿å­˜ç»ƒä¹ è®°å½•
      const modeNames = {
        before: 'é¥®é£Ÿå‰',
        during: 'é¥®é£Ÿä¸­',
        after: 'é¥®é£Ÿå'
      };
      
      const record = {
        id: Date.now(),
        title: `æ— ç½ªæ„Ÿé¥®é£Ÿç»ƒä¹ (${modeNames[practiceMode]})`,
        category: 'mindful',
        duration: Math.ceil(totalTime / 60),
        date: new Date().toISOString(),
        timestamp: Date.now()
      };

      const history = JSON.parse(localStorage.getItem('practiceHistory') || '[]');
      history.push(record);
      localStorage.setItem('practiceHistory', JSON.stringify(history));

      // æ˜¾ç¤ºå®Œæˆç•Œé¢
      document.getElementById('practiceModal').classList.add('hidden');
      document.getElementById('completionModal').classList.remove('hidden');
    }

    function closeCompletion() {
      document.getElementById('completionModal').classList.add('hidden');
      window.location.href = 'daily_practice.html';
    }

    function goToTool() {
      // è·³è½¬åˆ°æ·±åº¦å·¥å…·é¡µé¢
      window.location.href = 'eating-emotion-log.html';
    }
  </script>

</body>
</html>
