<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Êô®Èó¥ËßâÈÜíÂëºÂê∏ - MindFit</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
      background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%);
      color: #2E2E2E;
      min-height: 100vh;
    }

    /* ÂØºËà™Ê†è */
    nav {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid #E0E0E0;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .nav-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .nav-back {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: #666;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .nav-back:hover {
      color: #FFB84D;
      transform: translateX(-4px);
    }

    .nav-brand {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      color: #FFB84D;
    }

    /* ‰∏ªÂÜÖÂÆπ */
    main {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }

    .practice-stage {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .practice-stage.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ‰ªãÁªçÈ°µ */
    .practice-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .practice-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .practice-title {
      font-size: 2rem;
      font-weight: 700;
      color: #FFB84D;
      margin-bottom: 0.5rem;
    }

    .practice-description {
      font-size: 1.1rem;
      color: #666;
      margin-bottom: 1.5rem;
    }

    .practice-meta {
      display: flex;
      justify-content: center;
      gap: 2rem;
      color: #666;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .info-card {
      background: white;
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .info-card-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      color: #FFB84D;
      margin-bottom: 1rem;
    }

    .info-card-content {
      color: #666;
      line-height: 1.8;
    }

    .tag {
      display: inline-block;
      background: #FFF3E0;
      color: #FFB84D;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.9rem;
      margin-right: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .tips-list {
      list-style: none;
      padding: 0;
    }

    .tips-list li {
      padding-left: 1.5rem;
      position: relative;
      margin-bottom: 0.5rem;
      color: #666;
    }

    .tips-list li:before {
      content: 'üíö';
      position: absolute;
      left: 0;
    }

    .body-neutral-card {
      background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      display: flex;
      gap: 1rem;
      border: 2px solid #A5D6A7;
    }

    .body-neutral-card i {
      color: #66BB6A;
      font-size: 1.5rem;
    }

    .body-neutral-card p {
      color: #2E7D32;
      line-height: 1.8;
      font-weight: 500;
    }

    /* ÊåâÈíÆ */
    .btn-primary {
      background: #FFB84D;
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: 12px;
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background: #FFA726;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 184, 77, 0.3);
    }

    .btn-secondary {
      background: white;
      color: #2E2E2E;
      border: 2px solid #E0E0E0;
      padding: 1rem 2rem;
      border-radius: 12px;
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-secondary:hover {
      border-color: #FFB84D;
      background: #FFF3E0;
    }

    /* ÁªÉ‰π†È°µ */
    .timer-display {
      display: flex;
      justify-content: center;
      margin-bottom: 2rem;
    }

    .timer-circle {
      position: relative;
      width: 200px;
      height: 200px;
    }

    .timer-svg {
      transform: rotate(-90deg);
    }

    .timer-bg {
      fill: none;
      stroke: #E0E0E0;
      stroke-width: 8;
    }

    .timer-progress {
      fill: none;
      stroke: #FFB84D;
      stroke-width: 8;
      stroke-linecap: round;
      stroke-dasharray: 565.48;
      stroke-dashoffset: 565.48;
      transition: stroke-dashoffset 1s linear;
    }

    .timer-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2.5rem;
      font-weight: 700;
      color: #FFB84D;
    }

    .step-indicator {
      text-align: center;
      font-size: 1.1rem;
      color: #666;
      margin-bottom: 2rem;
    }

    .step-indicator span:first-child {
      font-size: 1.5rem;
      font-weight: 700;
      color: #FFB84D;
    }

    .step-content {
      background: white;
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      min-height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    }

    .step-text {
      font-size: 1.2rem;
      line-height: 1.8;
      color: #2E2E2E;
      text-align: center;
    }

    .practice-controls {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .practice-controls button {
      flex: 1;
    }

    /* ÂÆåÊàêÈ°µ */
    .celebration {
      text-align: center;
      margin-bottom: 2rem;
    }

    .celebration-icon {
      font-size: 5rem;
      margin-bottom: 1rem;
      animation: bounce 1s ease infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .celebration-title {
      font-size: 2rem;
      font-weight: 700;
      color: #FFB84D;
      margin-bottom: 0.5rem;
    }

    .celebration-text {
      font-size: 1.1rem;
      color: #666;
    }

    .feedback-form {
      background: white;
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    }

    .feedback-question {
      margin-bottom: 1.5rem;
    }

    .feedback-question label {
      display: block;
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .mood-selector {
      display: flex;
      justify-content: space-around;
      gap: 0.5rem;
    }

    .mood-btn {
      width: 60px;
      height: 60px;
      border: 3px solid #E0E0E0;
      border-radius: 50%;
      background: white;
      font-size: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .mood-btn:hover {
      transform: scale(1.1);
      border-color: #FFB84D;
    }

    .mood-btn.selected {
      border-color: #FFB84D;
      background: #FFF3E0;
      transform: scale(1.15);
    }

    textarea {
      width: 100%;
      padding: 1rem;
      border: 2px solid #E0E0E0;
      border-radius: 12px;
      font-family: inherit;
      font-size: 1rem;
      resize: vertical;
      min-height: 100px;
    }

    textarea:focus {
      outline: none;
      border-color: #FFB84D;
    }

    .complete-actions {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .btn-text {
      background: none;
      border: none;
      color: #666;
      cursor: pointer;
      padding: 0.5rem;
      text-decoration: none;
      display: block;
      text-align: center;
    }

    .btn-text:hover {
      color: #FFB84D;
    }

    /* Toast */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #FFB84D;
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transform: translateX(400px);
      transition: transform 0.3s ease;
      z-index: 1000;
    }

    .toast.show {
      transform: translateX(0);
    }

    @media (max-width: 768px) {
      .practice-title {
        font-size: 1.5rem;
      }
      
      .timer-circle {
        width: 160px;
        height: 160px;
      }
      
      .timer-text {
        font-size: 2rem;
      }
      
      .mood-btn {
        width: 50px;
        height: 50px;
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>

  <!-- ÂØºËà™Ê†è -->
  <nav>
    <div class="nav-container">
      <a href="daily_practice.html" class="nav-back">
        <i class="fa fa-arrow-left"></i>
        <span>ËøîÂõûÁªÉ‰π†</span>
      </a>
      <div class="nav-brand">
        <i class="fa fa-leaf"></i>
        <span>MindFit</span>
      </div>
    </div>
  </nav>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- ‰∏ªÂÜÖÂÆπ -->
  <main>
    <!-- ‰ªãÁªçÈò∂ÊÆµ -->
    <div id="intro-stage" class="practice-stage active">
      <div class="practice-header">
        <div class="practice-icon">üåÖ</div>
        <h1 class="practice-title">Êô®Èó¥ËßâÈÜíÂëºÂê∏</h1>
        <p class="practice-description">Áî®Ê∏©ÊüîÁöÑÂëºÂê∏Âî§ÈÜíË∫´‰ΩìÔºåÂºÄÂêØÂÖÖÊª°Ê¥ªÂäõÁöÑ‰∏ÄÂ§©</p>
        
        <div class="practice-meta">
          <span class="meta-item">
            <i class="fa fa-clock-o"></i>
            5ÂàÜÈíü
          </span>
          <span class="meta-item">
            <i class="fa fa-signal"></i>
            ÁÆÄÂçï
          </span>
        </div>
      </div>
      
      <div class="info-card">
        <div class="info-card-title">
          <i class="fa fa-lightbulb-o"></i>
          ‰∏∫‰ªÄ‰πàÊúâÊïàÔºü
        </div>
        <p class="info-card-content">Êó©Êô®ÁöÑÊ∑±ÂëºÂê∏ÂèØ‰ª•Â¢ûÂä†Ë°ÄÊ∂≤Âê´Ê∞ßÈáèÔºåÊøÄÊ¥ªÂâØ‰∫§ÊÑüÁ•ûÁªèÁ≥ªÁªüÔºåÂ∏ÆÂä©Ë∫´‰Ωì‰ªéÁù°Áú†Áä∂ÊÄÅÂπ≥Á®≥ËøáÊ∏°Âà∞Ê∏ÖÈÜíÁä∂ÊÄÅÔºåËÆ©‰Ω†‰ª•Êõ¥Â•ΩÁöÑÁä∂ÊÄÅÂºÄÂßãÊñ∞ÁöÑ‰∏ÄÂ§©„ÄÇ</p>
      </div>
      
      <div class="info-card">
        <div class="info-card-title">
          <i class="fa fa-calendar-check-o"></i>
          ÊúÄÈÄÇÂêà
        </div>
        <div class="info-card-content">
          <span class="tag">‚Ä¢ Ëµ∑Â∫äÂêéÁ´ãÂç≥ÁªÉ‰π†</span>
          <span class="tag">‚Ä¢ ÂºÄÂßãÂ∑•‰ΩúÂâç</span>
          <span class="tag">‚Ä¢ ÊÑüËßâÊòèÊ≤âÊó∂</span>
          <span class="tag">‚Ä¢ ÈúÄË¶ÅÊèêÁ•ûÊó∂</span>
        </div>
      </div>
      
      <div class="info-card">
        <div class="info-card-title">
          <i class="fa fa-heart-o"></i>
          Ê∏©È¶®ÊèêÁ§∫
        </div>
        <ul class="tips-list">
          <li>Â¶ÇÊûúËµ∑Â∫äÂêéÊÑüËßâÂ§¥ÊôïÔºåÂèØ‰ª•ÂÖàÂùê‰∏Ä‰ºöÂÑøÂÜçÂºÄÂßã</li>
          <li>‰∏çÈúÄË¶ÅÂº∫Ê±ÇÂÆåÁæéÁöÑËäÇÂ•èÔºåÊâæÂà∞Ëá™Â∑±ËàíÊúçÁöÑÈÄüÂ∫¶Â∞±Â•Ω</li>
          <li>ÂèØ‰ª•Âú®ÂëºÂê∏Êó∂ËΩªËΩªÊãâ‰º∏ËÑñÂ≠êÂíåËÇ©ËÜÄ</li>
          <li>Â¶ÇÊûúÊ≥®ÊÑèÂäõÂàÜÊï£‰∫ÜÔºåÊ∏©ÊüîÂú∞ÊääÂÆÉÂ∏¶ÂõûÂà∞ÂëºÂê∏‰∏ä</li>
        </ul>
      </div>
      
      <div class="body-neutral-card">
        <i class="fa fa-heart"></i>
        <p>ÊÑüË∞¢Ë∫´‰ΩìÁªô‰Ω†Êñ∞ÁöÑ‰∏ÄÂ§©„ÄÇÊØè‰∏ÄÊ¨°ÂëºÂê∏ÈÉΩÊòØË∫´‰ΩìÂú®ËøéÊé•Ê∏ÖÊô®Ôºå‰∏çÈúÄË¶ÅÂÆåÁæéÔºåÂè™ÈúÄË¶ÅÊ∏©ÊüîÂú∞Èô™‰º¥Ëá™Â∑±„ÄÇ</p>
      </div>
      
      <button class="btn-primary" onclick="startPractice()">
        <i class="fa fa-play"></i>
        ÂºÄÂßãÁªÉ‰π†
      </button>
    </div>

    <!-- ÁªÉ‰π†Èò∂ÊÆµ -->
    <div id="practice-stage" class="practice-stage">
      <div class="timer-display">
        <div class="timer-circle">
          <svg class="timer-svg" viewBox="0 0 200 200">
            <circle class="timer-bg" cx="100" cy="100" r="90"></circle>
            <circle class="timer-progress" id="timer-progress" cx="100" cy="100" r="90"></circle>
          </svg>
          <div class="timer-text" id="timer-text">5:00</div>
        </div>
      </div>
      
      <div class="step-indicator">
        <span id="current-step">1</span> / <span id="total-steps">8</span>
      </div>
      
      <div class="step-content">
        <div class="step-text" id="step-text"></div>
      </div>
      
      <div class="practice-controls">
        <button id="pause-btn" class="btn-secondary" onclick="togglePause()">
          <i class="fa fa-pause"></i>
          <span id="pause-text">ÊöÇÂÅú</span>
        </button>
        <button class="btn-primary" onclick="nextStep()">
          <span id="next-text">‰∏ã‰∏ÄÊ≠•</span>
          <i class="fa fa-arrow-right"></i>
        </button>
      </div>
      
      <button class="btn-text" onclick="endPractice()" style="width:100%">
        ÊèêÂâçÁªìÊùü
      </button>
    </div>

    <!-- ÂÆåÊàêÈò∂ÊÆµ -->
    <div id="complete-stage" class="practice-stage">
      <div class="celebration">
        <div class="celebration-icon">üéâ</div>
        <h2 class="celebration-title">Â§™Ê£í‰∫ÜÔºÅ</h2>
        <p class="celebration-text">‰Ω†ÂÆåÊàê‰∫Ü„ÄäÊô®Èó¥ËßâÈÜíÂëºÂê∏„Äã</p>
      </div>
      
      <div class="feedback-form">
        <div class="feedback-question">
          <label>ÁªÉ‰π†ÂêéÁöÑÊÑüÂèóÂ¶Ç‰ΩïÔºü</label>
          <div class="mood-selector">
            <button class="mood-btn" onclick="selectMood(this, 1)">üòü</button>
            <button class="mood-btn" onclick="selectMood(this, 2)">üòê</button>
            <button class="mood-btn" onclick="selectMood(this, 3)">üôÇ</button>
            <button class="mood-btn" onclick="selectMood(this, 4)">üòä</button>
            <button class="mood-btn" onclick="selectMood(this, 5)">üòÑ</button>
          </div>
        </div>
        
        <div class="feedback-question">
          <label>ÁÆÄÁü≠Á¨îËÆ∞ÔºàÂèØÈÄâÔºâ</label>
          <textarea id="practice-notes" placeholder="ËÆ∞ÂΩï‰Ω†ÁöÑÊÑüÂèóÂíåÊÉ≥Ê≥ï..."></textarea>
        </div>
      </div>
      
      <div class="complete-actions">
        <button class="btn-primary" onclick="saveRecord()">
          <i class="fa fa-check"></i>
          ‰øùÂ≠òËÆ∞ÂΩï
        </button>
        <button class="btn-secondary" onclick="location.reload()">
          <i class="fa fa-refresh"></i>
          ÂÜçÁªÉ‰∏ÄÊ¨°
        </button>
        <a href="daily_practice.html" class="btn-text">
          ËøîÂõûÁªÉ‰π†ÂàóË°®
        </a>
      </div>
    </div>
  </main>

  <script>
    // ÁªÉ‰π†ÈÖçÁΩÆ
    const GUIDE_STEPS = [
      'üõèÔ∏è ÂáÜÂ§áÔºöÂùêÂú®Â∫äËæπÊàñÊâæ‰∏Ä‰∏™ËàíÊúçÁöÑ‰ΩçÁΩÆÔºåËÆ©ËÑäÊ§éËá™ÁÑ∂Êå∫Áõ¥‰ΩÜ‰∏çÁ¥ßÁª∑',
      'üëÄ ËßâÂØüÔºöÈó≠‰∏äÁúºÁùõÔºåÊÑüÂèóË∫´‰ΩìÁé∞Âú®ÁöÑÁä∂ÊÄÅ„ÄÇÊ≥®ÊÑèÔºö‰∏çÈúÄË¶ÅËØÑÂà§Â•ΩÂùè',
      'üå¨Ô∏è Âê∏Ê∞îÔºöÈÄöËøáÈºªÂ≠êÁºìÊÖ¢Âê∏Ê∞î4ÁßíÔºåÊÑüÂèóÁ©∫Ê∞îËøõÂÖ•Ë∫´‰ΩìÔºåËÖπÈÉ®Ëá™ÁÑ∂Êâ©Âº†',
      '‚è∏Ô∏è ÂÅúÈ°øÔºöËΩªËΩªÂ±è‰ΩèÂëºÂê∏2ÁßíÔºå‰øùÊåÅÊîæÊùæÔºå‰∏çË¶ÅÁ¥ßÂº†',
      'üí® ÂëºÊ∞îÔºöÈÄöËøáÂò¥Â∑¥ÊÖ¢ÊÖ¢ÂëºÊ∞î6ÁßíÔºåÊÉ≥Ë±°ÈáäÊîæÊò®Â§©ÁöÑÁñ≤ÊÉ´',
      'üîÑ ÈáçÂ§çÔºöÁªßÁª≠Ëøô‰∏™ËäÇÂ•èÔºàÂê∏4-ÂÅú2-Âëº6ÔºâÔºåËøõË°å5-8‰∏™Âæ™ÁéØ',
      'üåÖ ÊÉ≥Ë±°ÔºöÊØèÊ¨°Âê∏Ê∞îÊó∂ÔºåÊÉ≥Ë±°Âê∏ÂÖ•Ê∏ÖÊô®ÁöÑÊñ∞È≤úËÉΩÈáèÂíåÊ∏©ÊöñÁöÑÈò≥ÂÖâ',
      'üíö ÊÑüË∞¢ÔºöÁªìÊùüÂâçÔºåÊääÊâãÊîæÂú®ÂøÉÂè£ÔºåÂØπË∫´‰ΩìËØ¥Ôºö"Ë∞¢Ë∞¢‰Ω†ÁªôÊàëÊñ∞ÁöÑ‰∏ÄÂ§©"'
    ];

    // ÂÖ®Â±ÄÂèòÈáè
    let currentStep = 0;
    let isPaused = false;
    let remainingTime = 300; // 5ÂàÜÈíü
    let timer = null;
    let selectedMoodValue = null;

    // ÂºÄÂßãÁªÉ‰π†
    function startPractice() {
      switchStage('intro-stage', 'practice-stage');
      currentStep = 0;
      showStep(0);
      startTimer();
      showToast('ÁªÉ‰π†ÂºÄÂßãÔºåËØ∑Ë∑üÈöèÊåáÂØºËøõË°å');
    }

    // ÊòæÁ§∫Ê≠•È™§
    function showStep(index) {
      document.getElementById('current-step').textContent = index + 1;
      document.getElementById('step-text').textContent = GUIDE_STEPS[index];
      
      const nextBtn = document.getElementById('next-text');
      if (index === GUIDE_STEPS.length - 1) {
        nextBtn.textContent = 'ÂÆåÊàê';
      } else {
        nextBtn.textContent = '‰∏ã‰∏ÄÊ≠•';
      }
    }

    // ‰∏ã‰∏ÄÊ≠•
    function nextStep() {
      currentStep++;
      if (currentStep >= GUIDE_STEPS.length) {
        completePractice();
      } else {
        showStep(currentStep);
      }
    }

    // ËÆ°Êó∂Âô®
    function startTimer() {
      if (timer) return;
      timer = setInterval(() => {
        if (!isPaused && remainingTime > 0) {
          remainingTime--;
          updateTimerDisplay();
        }
      }, 1000);
    }

    function updateTimerDisplay() {
      const mins = Math.floor(remainingTime / 60);
      const secs = remainingTime % 60;
      document.getElementById('timer-text').textContent = 
        `${mins}:${secs.toString().padStart(2, '0')}`;
      
      const progress = (300 - remainingTime) / 300;
      const circumference = 2 * Math.PI * 90;
      const offset = circumference - (progress * circumference);
      document.getElementById('timer-progress').style.strokeDashoffset = offset;
    }

    function togglePause() {
      isPaused = !isPaused;
      const pauseBtn = document.getElementById('pause-text');
      if (isPaused) {
        pauseBtn.textContent = 'ÁªßÁª≠';
      } else {
        pauseBtn.textContent = 'ÊöÇÂÅú';
      }
    }

    // ÂÆåÊàêÁªÉ‰π†
    function completePractice() {
      if (timer) {
        clearInterval(timer);
        timer = null;
      }
      switchStage('practice-stage', 'complete-stage');
      showConfetti();
      playSound();
    }

    // ÊèêÂâçÁªìÊùü
    function endPractice() {
      if (confirm('Á°ÆÂÆöË¶ÅÊèêÂâçÁªìÊùüÁªÉ‰π†ÂêóÔºü')) {
        location.href = 'daily_practice.html';
      }
    }

    // ÈÄâÊã©ÂøÉÊÉÖ
    function selectMood(btn, value) {
      document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      selectedMoodValue = value;
    }

    // ‰øùÂ≠òËÆ∞ÂΩï
    function saveRecord() {
      const notes = document.getElementById('practice-notes').value;
      const record = {
        id: Date.now(),
        title: 'Êô®Èó¥ËßâÈÜíÂëºÂê∏',
        category: 'morning',
        duration: 5,
        date: new Date().toISOString(),
        mood: selectedMoodValue,
        notes: notes.trim()
      };
      
      const history = JSON.parse(localStorage.getItem('practiceHistory') || '[]');
      history.push(record);
      localStorage.setItem('practiceHistory', JSON.stringify(history));
      
      showToast('ËÆ∞ÂΩïÂ∑≤‰øùÂ≠òÔºÅ');
      setTimeout(() => {
        location.href = 'daily_practice.html';
      }, 1500);
    }

    // ÂàáÊç¢Èò∂ÊÆµ
    function switchStage(fromId, toId) {
      document.getElementById(fromId).classList.remove('active');
      document.getElementById(toId).classList.add('active');
    }

    // Toast
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // ÂΩ©Â∏¶
    function showConfetti() {
      const colors = ['#FFB84D', '#FFA726', '#FF9800', '#FFD54F', '#FFECB3'];
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.style.cssText = `
          position: fixed;
          left: ${Math.random() * 100}%;
          top: -20px;
          width: 10px;
          height: 10px;
          background: ${colors[Math.floor(Math.random() * colors.length)]};
          animation: fall ${2 + Math.random() * 2}s ease-in forwards;
          z-index: 9999;
        `;
        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 5000);
      }
    }

    // Èü≥Êïà
    function playSound() {
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        [523.25, 659.25, 783.99].forEach((freq, i) => {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.frequency.value = freq;
          osc.type = 'sine';
          gain.gain.setValueAtTime(0.3, ctx.currentTime + i * 0.1);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + i * 0.1 + 0.3);
          osc.start(ctx.currentTime + i * 0.1);
          osc.stop(ctx.currentTime + i * 0.1 + 0.3);
        });
      } catch (e) {}
    }

    const style = document.createElement('style');
    style.textContent = '@keyframes fall { to { transform: translateY(100vh) rotate(720deg); opacity: 0; } }';
    document.head.appendChild(style);
  </script>

</body>
</html>
