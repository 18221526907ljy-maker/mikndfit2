<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¸ªäººä¸­å¿ƒ - MindFit</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="style.css">
  <style>
    .profile-header {
      background: linear-gradient(135deg, #0d9488 0%, #14b8a6 100%);
      padding: 40px 20px;
      text-align: center;
      color: white;
    }
    .avatar-wrapper {
      position: relative;
      display: inline-block;
      margin-bottom: 16px;
    }
    .avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      color: #0d9488;
      border: 4px solid rgba(255,255,255,0.3);
    }
    .avatar-edit {
      position: absolute;
      bottom: 0;
      right: 0;
      width: 32px;
      height: 32px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    .profile-info {
      margin-bottom: 20px;
    }
    .profile-name {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 8px;
    }
    .profile-stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-top: 20px;
    }
    .stat-item {
      text-align: center;
    }
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      display: block;
    }
    .stat-label {
      font-size: 14px;
      opacity: 0.9;
      margin-top: 4px;
    }
    .section {
      background: white;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 16px;
    }
    .section-title {
      font-size: 18px;
      font-weight: bold;
      color: #0d9488;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .menu-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 0;
      border-bottom: 1px solid #f0f0f0;
      cursor: pointer;
      transition: all 0.3s;
    }
    .menu-item:last-child {
      border-bottom: none;
    }
    .menu-item:hover {
      background: #f8fafc;
      padding-left: 8px;
      padding-right: 8px;
      border-radius: 8px;
    }
    .menu-item-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .menu-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    .achievement-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-top: 16px;
    }
    .achievement-card {
      text-align: center;
      padding: 16px;
      background: #f8fafc;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .achievement-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 12px rgba(13,148,136,0.2);
    }
    .achievement-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }
    .achievement-icon.locked {
      opacity: 0.3;
      filter: grayscale(1);
    }
    .achievement-name {
      font-size: 12px;
      color: #64748b;
      font-weight: 500;
    }
    .badge {
      background: #fee2e2;
      color: #dc2626;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }
    
    @media (max-width: 768px) {
      .achievement-grid {
        grid-template-columns: repeat(3, 1fr);
      }
      .profile-header {
        padding: 30px 20px;
      }
      .avatar {
        width: 80px;
        height: 80px;
        font-size: 32px;
      }
    }
  </style>
</head>
<body class="bg-secondary">

  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <nav class="bg-white border-b border-gray-200 sticky top-0 z-50 backdrop-blur-md bg-white/90">
    <div class="max-w-4xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <a href="index.html" class="flex items-center text-primary hover:text-mint transition-all duration-300 group">
            <span class="mr-2 transition-transform group-hover:-translate-x-1">â†</span>
            <span class="font-medium">è¿”å›é¦–é¡µ</span>
          </a>
        </div>
        <div class="flex items-center space-x-2">
          <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center">
            <i class="fa fa-user text-white text-sm"></i>
          </div>
          <span class="text-lg font-bold text-primary">ä¸ªäººä¸­å¿ƒ</span>
        </div>
      </div>
    </div>
  </nav>

  <main class="max-w-4xl mx-auto pb-20 md:pb-8">

    <!-- ä¸ªäººä¿¡æ¯å¤´éƒ¨ -->
    <div class="profile-header">
      <div class="avatar-wrapper">
        <div class="avatar">
          <i class="fa fa-user"></i>
        </div>
        <div class="avatar-edit" onclick="editAvatar()">
          <i class="fa fa-camera text-primary text-sm"></i>
        </div>
      </div>
      
      <div class="profile-info">
        <div class="profile-name" id="userName">MindFitç”¨æˆ·</div>
        <div style="opacity: 0.9; font-size: 14px;">åŠ å…¥æ—¶é—´: <span id="joinDate">2024å¹´1æœˆ</span></div>
      </div>

      <div class="profile-stats">
        <div class="stat-item">
          <span class="stat-value" id="practiceCount">0</span>
          <span class="stat-label">ç»ƒä¹ æ¬¡æ•°</span>
        </div>
        <div class="stat-item">
          <span class="stat-value" id="streakCount">0</span>
          <span class="stat-label">è¿ç»­å¤©æ•°</span>
        </div>
        <div class="stat-item">
          <span class="stat-value" id="achievementCount">0</span>
          <span class="stat-label">æˆå°±å¾½ç« </span>
        </div>
      </div>
    </div>

    <div class="px-4 py-6">

      <!-- æˆ‘çš„æˆå°± -->
      <div class="section">
        <div class="section-title">
          <i class="fa fa-trophy"></i>
          æˆ‘çš„æˆå°±
        </div>
        <div class="achievement-grid">
          <div class="achievement-card" onclick="showToast('å®Œæˆé¦–æ¬¡ç»ƒä¹ è§£é”')">
            <div class="achievement-icon" id="badge-first">ğŸ¯</div>
            <div class="achievement-name">åˆæ¬¡å°è¯•</div>
          </div>
          <div class="achievement-card" onclick="showToast('è¿ç»­ç»ƒä¹ 7å¤©è§£é”')">
            <div class="achievement-icon locked" id="badge-week">ğŸ”¥</div>
            <div class="achievement-name">åšæŒä¸€å‘¨</div>
          </div>
          <div class="achievement-card" onclick="showToast('å®Œæˆ10æ¬¡ç»ƒä¹ è§£é”')">
            <div class="achievement-icon locked" id="badge-ten">â­</div>
            <div class="achievement-name">ç»ƒä¹ è¾¾äºº</div>
          </div>
          <div class="achievement-card" onclick="showToast('å®Œæˆæ‰€æœ‰CBTå·¥å…·è§£é”')">
            <div class="achievement-icon locked" id="badge-cbt">ğŸ§ </div>
            <div class="achievement-name">CBTä¸“å®¶</div>
          </div>
        </div>
      </div>

      <!-- æˆ‘çš„æ•°æ® -->
      <div class="section">
        <div class="section-title">
          <i class="fa fa-bar-chart"></i>
          æˆ‘çš„æ•°æ®
        </div>
        <div class="menu-item" onclick="window.location.href='practice_records.html'">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #dbeafe; color: #3b82f6;">
              <i class="fa fa-history"></i>
            </div>
            <span>ç»ƒä¹ è®°å½•</span>
          </div>
          <i class="fa fa-chevron-right text-gray-400"></i>
        </div>
        <div class="menu-item" onclick="window.location.href='self-assessment.html'">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #f3e8ff; color: #a855f7;">
              <i class="fa fa-clipboard"></i>
            </div>
            <span>æµ‹è¯„è®°å½•</span>
          </div>
          <i class="fa fa-chevron-right text-gray-400"></i>
        </div>
        <div class="menu-item" onclick="window.location.href='cbt_tools.html'">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #dcfce7; color: #16a34a;">
              <i class="fa fa-brain"></i>
            </div>
            <span>CBTè®°å½•</span>
          </div>
          <i class="fa fa-chevron-right text-gray-400"></i>
        </div>
      </div>

      <!-- è®¾ç½®ä¸å¸®åŠ© -->
      <div class="section">
        <div class="section-title">
          <i class="fa fa-cog"></i>
          è®¾ç½®ä¸å¸®åŠ©
        </div>
        <div class="menu-item" onclick="editProfile()">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #fef3c7; color: #f59e0b;">
              <i class="fa fa-edit"></i>
            </div>
            <span>ç¼–è¾‘èµ„æ–™</span>
          </div>
          <i class="fa fa-chevron-right text-gray-400"></i>
        </div>
        <div class="menu-item" onclick="showNotificationSettings()">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #fce7f3; color: #ec4899;">
              <i class="fa fa-bell"></i>
            </div>
            <span>é€šçŸ¥è®¾ç½®</span>
          </div>
          <i class="fa fa-chevron-right text-gray-400"></i>
        </div>
        <div class="menu-item" onclick="showPrivacySettings()">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #e0e7ff; color: #6366f1;">
              <i class="fa fa-lock"></i>
            </div>
            <span>éšç§è®¾ç½®</span>
          </div>
          <i class="fa fa-chevron-right text-gray-400"></i>
        </div>
        <div class="menu-item" onclick="showFeedback()">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #d1fae5; color: #10b981;">
              <i class="fa fa-comment"></i>
            </div>
            <span>æ„è§åé¦ˆ</span>
          </div>
          <i class="fa fa-chevron-right text-gray-400"></i>
        </div>
        <div class="menu-item" onclick="showAbout()">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #e5e7eb; color: #6b7280;">
              <i class="fa fa-info-circle"></i>
            </div>
            <span>å…³äºæˆ‘ä»¬</span>
          </div>
          <i class="fa fa-chevron-right text-gray-400"></i>
        </div>
      </div>

      <!-- é€€å‡ºç™»å½• -->
      <div class="section">
        <div class="menu-item" onclick="logout()" style="color: #dc2626;">
          <div class="menu-item-left">
            <div class="menu-icon" style="background: #fee2e2; color: #dc2626;">
              <i class="fa fa-sign-out"></i>
            </div>
            <span>é€€å‡ºç™»å½•</span>
          </div>
        </div>
      </div>

    </div>

  </main>

  <!-- Toast æç¤º -->
  <div id="toast" class="toast">
    <div class="flex items-center">
      <span class="mr-2">âœ“</span>
      <span id="toastMessage"></span>
    </div>
  </div>

  <!-- ç§»åŠ¨ç«¯åº•éƒ¨å¯¼èˆª -->
  <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-200 z-50">
    <div class="flex justify-around py-2">
      <button class="flex flex-col items-center py-2 px-3 text-gray-500" onclick="window.location.href='index.html'">
        <i class="fa fa-home text-lg mb-1"></i>
        <span class="text-xs">é¦–é¡µ</span>
      </button>
      <button class="flex flex-col items-center py-2 px-3 text-gray-500" onclick="window.location.href='self-assessment.html'">
        <i class="fa fa-clipboard text-lg mb-1"></i>
        <span class="text-xs">æµ‹è¯„</span>
      </button>
      <button class="flex flex-col items-center py-2 px-3 text-gray-500" onclick="window.location.href='daily_practice.html'">
        <i class="fa fa-leaf text-lg mb-1"></i>
        <span class="text-xs">ç»ƒä¹ </span>
      </button>
      <button class="flex flex-col items-center py-2 px-3 text-gray-500" onclick="window.location.href='practice_records.html'">
        <i class="fa fa-chart-line text-lg mb-1"></i>
        <span class="text-xs">è®°å½•</span>
      </button>
      <button class="flex flex-col items-center py-2 px-3 text-primary">
        <i class="fa fa-user text-lg mb-1"></i>
        <span class="text-xs font-medium">æˆ‘çš„</span>
      </button>
    </div>
  </nav>

  <script>
    // Toast æç¤ºåŠŸèƒ½
    function showToast(message) {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      toastMessage.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 2000);
    }

    // æ•°æ®åº“æ“ä½œ
    const DB_KEY = "mindfit_db_v1";

    function loadDB() {
      try {
        const raw = localStorage.getItem(DB_KEY);
        return raw ? JSON.parse(raw) : {
          practiceHistory: [],
          streak: { count: 0, lastDate: "" },
          badges: {},
          userName: "MindFitç”¨æˆ·",
          joinDate: new Date().toISOString()
        };
      } catch (e) {
        return {
          practiceHistory: [],
          streak: { count: 0, lastDate: "" },
          badges: {},
          userName: "MindFitç”¨æˆ·",
          joinDate: new Date().toISOString()
        };
      }
    }

    function saveDB(db) {
      localStorage.setItem(DB_KEY, JSON.stringify(db));
    }

    // åŠ è½½ç”¨æˆ·æ•°æ®
    function loadUserData() {
      const db = loadDB();
      
      // è®¾ç½®ç”¨æˆ·å
      document.getElementById('userName').textContent = db.userName || 'MindFitç”¨æˆ·';
      
      // è®¾ç½®åŠ å…¥æ—¶é—´
      const joinDate = new Date(db.joinDate || Date.now());
      document.getElementById('joinDate').textContent = 
        `${joinDate.getFullYear()}å¹´${joinDate.getMonth() + 1}æœˆ`;
      
      // è®¾ç½®ç»ƒä¹ æ¬¡æ•°
      document.getElementById('practiceCount').textContent = 
        db.practiceHistory?.length || 0;
      
      // è®¾ç½®è¿ç»­å¤©æ•°
      document.getElementById('streakCount').textContent = 
        db.streak?.count || 0;
      
      // è®¾ç½®æˆå°±æ•°é‡
      const achievementCount = Object.values(db.badges || {}).filter(Boolean).length;
      document.getElementById('achievementCount').textContent = achievementCount;
      
      // æ›´æ–°å¾½ç« çŠ¶æ€
      updateBadges(db.badges || {});
    }

    // æ›´æ–°å¾½ç« æ˜¾ç¤º
    function updateBadges(badges) {
      if (badges.firstPractice) {
        document.getElementById('badge-first').classList.remove('locked');
      }
      if (badges.weekStreak) {
        document.getElementById('badge-week').classList.remove('locked');
      }
      if (badges.tenPractices) {
        document.getElementById('badge-ten').classList.remove('locked');
      }
      if (badges.cbtMaster) {
        document.getElementById('badge-cbt').classList.remove('locked');
      }
    }

    // ç¼–è¾‘å¤´åƒ
    function editAvatar() {
      showToast('å¤´åƒä¸Šä¼ åŠŸèƒ½å¼€å‘ä¸­...');
    }

    // ç¼–è¾‘èµ„æ–™
    function editProfile() {
      const db = loadDB();
      const newName = prompt('è¯·è¾“å…¥æ–°çš„æ˜µç§°:', db.userName || 'MindFitç”¨æˆ·');
      if (newName && newName.trim()) {
        db.userName = newName.trim();
        saveDB(db);
        document.getElementById('userName').textContent = newName.trim();
        showToast('æ˜µç§°ä¿®æ”¹æˆåŠŸ!');
      }
    }

    // é€šçŸ¥è®¾ç½®
    function showNotificationSettings() {
      showToast('é€šçŸ¥è®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...');
    }

    // éšç§è®¾ç½®
    function showPrivacySettings() {
      showToast('éšç§è®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...');
    }

    // æ„è§åé¦ˆ
    function showFeedback() {
      const feedback = prompt('è¯·è¾“å…¥æ‚¨çš„æ„è§æˆ–å»ºè®®:');
      if (feedback && feedback.trim()) {
        showToast('æ„Ÿè°¢æ‚¨çš„åé¦ˆ!æˆ‘ä»¬ä¼šè®¤çœŸè€ƒè™‘');
      }
    }

    // å…³äºæˆ‘ä»¬
    function showAbout() {
      alert('MindFit - èº«å¿ƒå¥åº·ç®¡ç†å¹³å°\n\nç‰ˆæœ¬: 1.0.0\n\nå¸®åŠ©ç”¨æˆ·ç§‘å­¦ç®¡ç†èº«å¿ƒå¥åº·,å‘Šåˆ«èº«æç„¦è™‘');
    }

    // é€€å‡ºç™»å½•
    function logout() {
      if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—?')) {
        // è¿™é‡Œå¯ä»¥æ·»åŠ æ¸…é™¤ç”¨æˆ·ä¼šè¯çš„é€»è¾‘
        showToast('å·²é€€å‡ºç™»å½•');
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1500);
      }
    }

    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      loadUserData();
      showToast('æ¬¢è¿å›æ¥!');
    });
  </script>

</body>
</html>
